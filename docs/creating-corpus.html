<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Creating Corpus | Corpus Linguistics</title>
  <meta name="description" content="ENC2036 Course material first edition" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Creating Corpus | Corpus Linguistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="ENC2036 Course material first edition" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Creating Corpus | Corpus Linguistics" />
  
  <meta name="twitter:description" content="ENC2036 Course material first edition" />
  

<meta name="author" content="Alvin Cheng-Hsien Chen" />


<meta name="date" content="2022-02-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-fundamentals.html"/>
<link rel="next" href="corpus-analysis-a-start.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style-new.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://alvinntnu.github.io/NTNU_ENC2036/"><img src="images/alerts/home.svg" height = "20" width = "20"> Course Website</a></li>
<li><a href="./"><img src="images/alerts/book-solid.svg" height = "20" width = "20"> ENC 2036 Corpus Linguistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-objective"><i class="fa fa-check"></i>Course Objective</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reading-materials"><i class="fa fa-check"></i>Reading Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-requirement"><i class="fa fa-check"></i>Course Requirement</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#exams"><i class="fa fa-check"></i>Exams</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-website"><i class="fa fa-check"></i>Course Website</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing-to-the-lecture-notes"><i class="fa fa-check"></i>Contributing to the Lecture Notes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-demo-data"><i class="fa fa-check"></i>Course Demo Data</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#academic-integrity"><i class="fa fa-check"></i>Academic Integrity</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#house-keeping-guidelines"><i class="fa fa-check"></i>House-keeping Guidelines</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#necessary-packages"><i class="fa fa-check"></i>Necessary Packages</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#environment-settings"><i class="fa fa-check"></i>Environment Settings</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="what-is-corpus-linguistics.html"><a href="what-is-corpus-linguistics.html"><i class="fa fa-check"></i><b>1</b> What is Corpus Linguistics?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-corpus-linguistics.html"><a href="what-is-corpus-linguistics.html#why-do-we-need-corpus-data"><i class="fa fa-check"></i><b>1.1</b> Why do we need corpus data?</a></li>
<li class="chapter" data-level="1.2" data-path="what-is-corpus-linguistics.html"><a href="what-is-corpus-linguistics.html#what-is-corpus"><i class="fa fa-check"></i><b>1.2</b> What is corpus?</a></li>
<li class="chapter" data-level="1.3" data-path="what-is-corpus-linguistics.html"><a href="what-is-corpus-linguistics.html#what-is-a-corpus-linguistic-study"><i class="fa fa-check"></i><b>1.3</b> What is a corpus linguistic study?</a></li>
<li class="chapter" data-level="1.4" data-path="what-is-corpus-linguistics.html"><a href="what-is-corpus-linguistics.html#additional-information-on-cl"><i class="fa fa-check"></i><b>1.4</b> Additional Information on CL</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>2</b> R Fundamentals</a>
<ul>
<li class="chapter" data-level="" data-path="r-fundamentals.html"><a href="r-fundamentals.html#a-quick-note"><i class="fa fa-check"></i>A Quick Note</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="creating-corpus.html"><a href="creating-corpus.html"><i class="fa fa-check"></i><b>3</b> Creating Corpus</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-corpus.html"><a href="creating-corpus.html#html-structure"><i class="fa fa-check"></i><b>3.1</b> HTML Structure</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="creating-corpus.html"><a href="creating-corpus.html#html-syntax"><i class="fa fa-check"></i><b>3.1.1</b> HTML Syntax</a></li>
<li class="chapter" data-level="3.1.2" data-path="creating-corpus.html"><a href="creating-corpus.html#tags-and-attributes"><i class="fa fa-check"></i><b>3.1.2</b> Tags and Attributes</a></li>
<li class="chapter" data-level="3.1.3" data-path="creating-corpus.html"><a href="creating-corpus.html#css"><i class="fa fa-check"></i><b>3.1.3</b> CSS</a></li>
<li class="chapter" data-level="3.1.4" data-path="creating-corpus.html"><a href="creating-corpus.html#html-css-javascript"><i class="fa fa-check"></i><b>3.1.4</b> HTML + CSS ( + JavaScript)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="creating-corpus.html"><a href="creating-corpus.html#web-crawling"><i class="fa fa-check"></i><b>3.2</b> Web Crawling</a></li>
<li class="chapter" data-level="3.3" data-path="creating-corpus.html"><a href="creating-corpus.html#functional-programming"><i class="fa fa-check"></i><b>3.3</b> Functional Programming</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="creating-corpus.html"><a href="creating-corpus.html#extract_art_links"><i class="fa fa-check"></i><b>3.3.1</b> <code>extract_art_links()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="creating-corpus.html"><a href="creating-corpus.html#extract_article_push_tables"><i class="fa fa-check"></i><b>3.3.2</b> <code>extract_article_push_tables()</code></a></li>
<li class="chapter" data-level="3.3.3" data-path="creating-corpus.html"><a href="creating-corpus.html#streamline-the-codes"><i class="fa fa-check"></i><b>3.3.3</b> Streamline the Codes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="creating-corpus.html"><a href="creating-corpus.html#save-corpus"><i class="fa fa-check"></i><b>3.4</b> Save Corpus</a></li>
<li class="chapter" data-level="3.5" data-path="creating-corpus.html"><a href="creating-corpus.html#additional-resources"><i class="fa fa-check"></i><b>3.5</b> Additional Resources</a></li>
<li class="chapter" data-level="3.6" data-path="creating-corpus.html"><a href="creating-corpus.html#final-remarks"><i class="fa fa-check"></i><b>3.6</b> Final Remarks</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html"><i class="fa fa-check"></i><b>4</b> Corpus Analysis: A Start</a>
<ul>
<li class="chapter" data-level="4.1" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#installing-quanteda"><i class="fa fa-check"></i><b>4.1</b> Installing <code>quanteda</code></a></li>
<li class="chapter" data-level="4.2" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#building-a-corpus-from-character-vector"><i class="fa fa-check"></i><b>4.2</b> Building a <code>corpus</code> from character vector</a></li>
<li class="chapter" data-level="4.3" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#keyword-in-context-kwic"><i class="fa fa-check"></i><b>4.3</b> Keyword-in-Context (KWIC)</a></li>
<li class="chapter" data-level="4.4" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#kwic-with-regular-expressions"><i class="fa fa-check"></i><b>4.4</b> KWIC with Regular Expressions</a></li>
<li class="chapter" data-level="4.5" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#tidy-text-format-of-the-corpus"><i class="fa fa-check"></i><b>4.5</b> Tidy Text Format of the Corpus</a></li>
<li class="chapter" data-level="4.6" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#frequency-lists"><i class="fa fa-check"></i><b>4.6</b> Frequency Lists</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#word-unigram"><i class="fa fa-check"></i><b>4.6.1</b> Word (Unigram)</a></li>
<li class="chapter" data-level="4.6.2" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#bigrams"><i class="fa fa-check"></i><b>4.6.2</b> Bigrams</a></li>
<li class="chapter" data-level="4.6.3" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#ngrams-lexical-bundles"><i class="fa fa-check"></i><b>4.6.3</b> Ngrams (Lexical Bundles)</a></li>
<li class="chapter" data-level="4.6.4" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#frequency-and-dispersion"><i class="fa fa-check"></i><b>4.6.4</b> Frequency and Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#word-cloud"><i class="fa fa-check"></i><b>4.7</b> Word Cloud</a></li>
<li class="chapter" data-level="4.8" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#collocations"><i class="fa fa-check"></i><b>4.8</b> Collocations</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#cooccurrence-table-and-observed-frequencies"><i class="fa fa-check"></i><b>4.8.1</b> Cooccurrence Table and Observed Frequencies</a></li>
<li class="chapter" data-level="4.8.2" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#expected-frequencies"><i class="fa fa-check"></i><b>4.8.2</b> Expected Frequencies</a></li>
<li class="chapter" data-level="4.8.3" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#association-measures"><i class="fa fa-check"></i><b>4.8.3</b> Association Measures</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="corpus-analysis-a-start.html"><a href="corpus-analysis-a-start.html#constructions"><i class="fa fa-check"></i><b>4.9</b> Constructions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html"><i class="fa fa-check"></i><b>5</b> Parts-of-Speech Tagging</a>
<ul>
<li class="chapter" data-level="5.1" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#installing-the-package"><i class="fa fa-check"></i><b>5.1</b> Installing the Package</a></li>
<li class="chapter" data-level="5.2" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#quick-overview"><i class="fa fa-check"></i><b>5.2</b> Quick Overview</a></li>
<li class="chapter" data-level="5.3" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#working-pipeline"><i class="fa fa-check"></i><b>5.3</b> Working Pipeline</a></li>
<li class="chapter" data-level="5.4" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#parsing-your-texts"><i class="fa fa-check"></i><b>5.4</b> Parsing Your Texts</a></li>
<li class="chapter" data-level="5.5" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#metalingusitic-analysis"><i class="fa fa-check"></i><b>5.5</b> Metalingusitic Analysis</a></li>
<li class="chapter" data-level="5.6" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#construction-analysis"><i class="fa fa-check"></i><b>5.6</b> Construction Analysis</a></li>
<li class="chapter" data-level="5.7" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#issues-on-pattern-retrieval"><i class="fa fa-check"></i><b>5.7</b> Issues on Pattern Retrieval</a></li>
<li class="chapter" data-level="5.8" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#saving-pos-tagged-texts"><i class="fa fa-check"></i><b>5.8</b> Saving POS-tagged Texts</a></li>
<li class="chapter" data-level="5.9" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#finalize-spacy"><i class="fa fa-check"></i><b>5.9</b> Finalize spaCy</a></li>
<li class="chapter" data-level="5.10" data-path="parts-of-speech-tagging.html"><a href="parts-of-speech-tagging.html#notes-on-chinese-processing"><i class="fa fa-check"></i><b>5.10</b> Notes on Chinese Processing</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="keyword-analysis.html"><a href="keyword-analysis.html"><i class="fa fa-check"></i><b>6</b> Keyword Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="keyword-analysis.html"><a href="keyword-analysis.html#about-keywords"><i class="fa fa-check"></i><b>6.1</b> About Keywords</a></li>
<li class="chapter" data-level="6.2" data-path="keyword-analysis.html"><a href="keyword-analysis.html#statistics-for-keyness"><i class="fa fa-check"></i><b>6.2</b> Statistics for Keyness</a></li>
<li class="chapter" data-level="6.3" data-path="keyword-analysis.html"><a href="keyword-analysis.html#implementation"><i class="fa fa-check"></i><b>6.3</b> Implementation</a></li>
<li class="chapter" data-level="6.4" data-path="keyword-analysis.html"><a href="keyword-analysis.html#tidy-data"><i class="fa fa-check"></i><b>6.4</b> Tidy Data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="keyword-analysis.html"><a href="keyword-analysis.html#an-long-to-wide-example"><i class="fa fa-check"></i><b>6.4.1</b> An Long-to-Wide Example</a></li>
<li class="chapter" data-level="6.4.2" data-path="keyword-analysis.html"><a href="keyword-analysis.html#a-wide-to-long-example"><i class="fa fa-check"></i><b>6.4.2</b> A Wide-to-Long Example</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="keyword-analysis.html"><a href="keyword-analysis.html#word-frequency-transformation"><i class="fa fa-check"></i><b>6.5</b> Word Frequency Transformation</a></li>
<li class="chapter" data-level="6.6" data-path="keyword-analysis.html"><a href="keyword-analysis.html#computing-keynesss"><i class="fa fa-check"></i><b>6.6</b> Computing Keynesss</a></li>
<li class="chapter" data-level="6.7" data-path="keyword-analysis.html"><a href="keyword-analysis.html#conclusion"><i class="fa fa-check"></i><b>6.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html"><i class="fa fa-check"></i><b>7</b> Chinese Text Processing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#chinese-word-segmenter-jiebar"><i class="fa fa-check"></i><b>7.1</b> Chinese Word Segmenter <code>jiebaR</code></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#start"><i class="fa fa-check"></i><b>7.1.1</b> Start</a></li>
<li class="chapter" data-level="7.1.2" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#parameters-setting"><i class="fa fa-check"></i><b>7.1.2</b> Parameters Setting</a></li>
<li class="chapter" data-level="7.1.3" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#user-defined-dictionary"><i class="fa fa-check"></i><b>7.1.3</b> User-defined dictionary</a></li>
<li class="chapter" data-level="7.1.4" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#stopwords"><i class="fa fa-check"></i><b>7.1.4</b> Stopwords</a></li>
<li class="chapter" data-level="7.1.5" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#pos-tagging"><i class="fa fa-check"></i><b>7.1.5</b> POS Tagging</a></li>
<li class="chapter" data-level="7.1.6" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#default-word-lists-in-jiebar"><i class="fa fa-check"></i><b>7.1.6</b> Default Word Lists in JiebaR</a></li>
<li class="chapter" data-level="7.1.7" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#reminders"><i class="fa fa-check"></i><b>7.1.7</b> Reminders</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#chinese-text-analytics-pipeline"><i class="fa fa-check"></i><b>7.2</b> Chinese Text Analytics Pipeline</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#creating-a-corpus-object"><i class="fa fa-check"></i><b>7.2.1</b> Creating a Corpus Object</a></li>
<li class="chapter" data-level="7.2.2" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#tidy-structure-framework"><i class="fa fa-check"></i><b>7.2.2</b> Tidy Structure Framework</a></li>
<li class="chapter" data-level="7.2.3" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#quanteda-framework"><i class="fa fa-check"></i><b>7.2.3</b> <code>Quanteda</code> Framework</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#comparing-tokenization-methods"><i class="fa fa-check"></i><b>7.3</b> Comparing Tokenization Methods</a></li>
<li class="chapter" data-level="7.4" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#data"><i class="fa fa-check"></i><b>7.4</b> Data</a></li>
<li class="chapter" data-level="7.5" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#loading-text-data"><i class="fa fa-check"></i><b>7.5</b> Loading Text Data</a></li>
<li class="chapter" data-level="7.6" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#quantedatokens-vs.-jiebarsegment"><i class="fa fa-check"></i><b>7.6</b> <code>quanteda::tokens()</code> vs. <code>jiebaR::segment()</code></a></li>
<li class="chapter" data-level="7.7" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#case-study-1-word-frequency-and-wordcloud"><i class="fa fa-check"></i><b>7.7</b> Case Study 1: Word Frequency and Wordcloud</a></li>
<li class="chapter" data-level="7.8" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#case-study-2-patterns"><i class="fa fa-check"></i><b>7.8</b> Case Study 2: Patterns</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#bei-construction"><i class="fa fa-check"></i><b>7.8.1</b> BEI Construction</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#case-study-3-lexical-bundles"><i class="fa fa-check"></i><b>7.9</b> Case Study 3: Lexical Bundles</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#n-grams-extraction"><i class="fa fa-check"></i><b>7.9.1</b> N-grams Extraction</a></li>
<li class="chapter" data-level="7.9.2" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#frequency-and-dispersion-1"><i class="fa fa-check"></i><b>7.9.2</b> Frequency and Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="chinese-text-processing.html"><a href="chinese-text-processing.html#afterwords"><i class="fa fa-check"></i><b>7.10</b> Afterwords</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html"><i class="fa fa-check"></i><b>8</b> Constructions and Idioms</a>
<ul>
<li class="chapter" data-level="8.1" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#collostruction"><i class="fa fa-check"></i><b>8.1</b> Collostruction</a></li>
<li class="chapter" data-level="8.2" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#corpus"><i class="fa fa-check"></i><b>8.2</b> Corpus</a></li>
<li class="chapter" data-level="8.3" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#word-segmentation"><i class="fa fa-check"></i><b>8.3</b> Word Segmentation</a></li>
<li class="chapter" data-level="8.4" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#extract-constructions"><i class="fa fa-check"></i><b>8.4</b> Extract Constructions</a></li>
<li class="chapter" data-level="8.5" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#distributional-information-needed-for-ca"><i class="fa fa-check"></i><b>8.5</b> Distributional Information Needed for CA</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#word-frequency-list"><i class="fa fa-check"></i><b>8.5.1</b> Word Frequency List</a></li>
<li class="chapter" data-level="8.5.2" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#joint-frequencies"><i class="fa fa-check"></i><b>8.5.2</b> Joint Frequencies</a></li>
<li class="chapter" data-level="8.5.3" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#input-for-coll.analysis.r"><i class="fa fa-check"></i><b>8.5.3</b> Input for <code>coll.analysis.r</code></a></li>
<li class="chapter" data-level="8.5.4" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#other-information"><i class="fa fa-check"></i><b>8.5.4</b> Other Information</a></li>
<li class="chapter" data-level="8.5.5" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#create-output-file"><i class="fa fa-check"></i><b>8.5.5</b> Create Output File</a></li>
<li class="chapter" data-level="8.5.6" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#run-coll.analysis.r"><i class="fa fa-check"></i><b>8.5.6</b> Run <code>coll.analysis.r</code></a></li>
<li class="chapter" data-level="8.5.7" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#interpretations"><i class="fa fa-check"></i><b>8.5.7</b> Interpretations</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="constructions-and-idioms.html"><a href="constructions-and-idioms.html#exercises"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ckiptagger.html"><a href="ckiptagger.html"><i class="fa fa-check"></i><b>9</b> CKIP Tagger</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ckiptagger.html"><a href="ckiptagger.html#installation"><i class="fa fa-check"></i><b>9.1</b> Installation</a></li>
<li class="chapter" data-level="9.2" data-path="ckiptagger.html"><a href="ckiptagger.html#download-the-model-files"><i class="fa fa-check"></i><b>9.2</b> Download the Model Files</a></li>
<li class="chapter" data-level="9.3" data-path="ckiptagger.html"><a href="ckiptagger.html#r-python-communication"><i class="fa fa-check"></i><b>9.3</b> R-Python Communication</a></li>
<li class="chapter" data-level="9.4" data-path="ckiptagger.html"><a href="ckiptagger.html#word-segmentation-in-r"><i class="fa fa-check"></i><b>9.4</b> Word Segmentation in R</a></li>
<li class="chapter" data-level="9.5" data-path="ckiptagger.html"><a href="ckiptagger.html#r-environment-setting"><i class="fa fa-check"></i><b>9.5</b> R Environment Setting</a></li>
<li class="chapter" data-level="9.6" data-path="ckiptagger.html"><a href="ckiptagger.html#creating-conda-environment-for-ckiptagger"><i class="fa fa-check"></i><b>9.6</b> Creating Conda Environment for <code>ckiptagger</code></a></li>
<li class="chapter" data-level="9.7" data-path="ckiptagger.html"><a href="ckiptagger.html#initialization"><i class="fa fa-check"></i><b>9.7</b> Initialization</a></li>
<li class="chapter" data-level="9.8" data-path="ckiptagger.html"><a href="ckiptagger.html#segmenting-texts"><i class="fa fa-check"></i><b>9.8</b> Segmenting Texts</a></li>
<li class="chapter" data-level="9.9" data-path="ckiptagger.html"><a href="ckiptagger.html#define-own-dictionary"><i class="fa fa-check"></i><b>9.9</b> Define Own Dictionary</a></li>
<li class="chapter" data-level="9.10" data-path="ckiptagger.html"><a href="ckiptagger.html#beyond-word-boundaries"><i class="fa fa-check"></i><b>9.10</b> Beyond Word Boundaries</a></li>
<li class="chapter" data-level="9.11" data-path="ckiptagger.html"><a href="ckiptagger.html#tidy-up-the-results"><i class="fa fa-check"></i><b>9.11</b> Tidy Up the Results</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="structured-corpus.html"><a href="structured-corpus.html"><i class="fa fa-check"></i><b>10</b> Structured Corpus</a>
<ul>
<li class="chapter" data-level="10.1" data-path="structured-corpus.html"><a href="structured-corpus.html#nccu-spoken-mandarin"><i class="fa fa-check"></i><b>10.1</b> NCCU Spoken Mandarin</a></li>
<li class="chapter" data-level="10.2" data-path="structured-corpus.html"><a href="structured-corpus.html#childes-format"><i class="fa fa-check"></i><b>10.2</b> CHILDES Format</a></li>
<li class="chapter" data-level="10.3" data-path="structured-corpus.html"><a href="structured-corpus.html#loading-the-corpus"><i class="fa fa-check"></i><b>10.3</b> Loading the Corpus</a></li>
<li class="chapter" data-level="10.4" data-path="structured-corpus.html"><a href="structured-corpus.html#from-text-based-to-turn-based-df"><i class="fa fa-check"></i><b>10.4</b> From Text-based to Turn-based DF</a></li>
<li class="chapter" data-level="10.5" data-path="structured-corpus.html"><a href="structured-corpus.html#metadata-vs.-utterances"><i class="fa fa-check"></i><b>10.5</b> Metadata vs. Utterances</a></li>
<li class="chapter" data-level="10.6" data-path="structured-corpus.html"><a href="structured-corpus.html#word-based-df-and-frequency-list"><i class="fa fa-check"></i><b>10.6</b> Word-based DF and Frequency List</a></li>
<li class="chapter" data-level="10.7" data-path="structured-corpus.html"><a href="structured-corpus.html#concordances"><i class="fa fa-check"></i><b>10.7</b> Concordances</a></li>
<li class="chapter" data-level="10.8" data-path="structured-corpus.html"><a href="structured-corpus.html#collocations-bigrams"><i class="fa fa-check"></i><b>10.8</b> Collocations (Bigrams)</a></li>
<li class="chapter" data-level="10.9" data-path="structured-corpus.html"><a href="structured-corpus.html#n-grams-lexical-bundles"><i class="fa fa-check"></i><b>10.9</b> N-grams (Lexical Bundles)</a></li>
<li class="chapter" data-level="10.10" data-path="structured-corpus.html"><a href="structured-corpus.html#connecting-spid-to-metadata"><i class="fa fa-check"></i><b>10.10</b> Connecting SPID to Metadata</a></li>
<li class="chapter" data-level="10.11" data-path="structured-corpus.html"><a href="structured-corpus.html#corpus-headers"><i class="fa fa-check"></i><b>10.11</b> Corpus Headers</a></li>
<li class="chapter" data-level="10.12" data-path="structured-corpus.html"><a href="structured-corpus.html#sociolinguistic-analyses"><i class="fa fa-check"></i><b>10.12</b> Sociolinguistic Analyses</a>
<ul>
<li class="chapter" data-level="10.12.1" data-path="structured-corpus.html"><a href="structured-corpus.html#check-bigrams-distribution-by-age-groups"><i class="fa fa-check"></i><b>10.12.1</b> Check Bigrams Distribution By Age Groups</a></li>
<li class="chapter" data-level="10.12.2" data-path="structured-corpus.html"><a href="structured-corpus.html#numbers-of-bigrams-above-cut-off-by-age"><i class="fa fa-check"></i><b>10.12.2</b> Numbers of Bigrams above Cut-off by Age</a></li>
<li class="chapter" data-level="10.12.3" data-path="structured-corpus.html"><a href="structured-corpus.html#bigram-word-clouds-by-age"><i class="fa fa-check"></i><b>10.12.3</b> Bigram Word clouds by Age</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="xml.html"><a href="xml.html"><i class="fa fa-check"></i><b>11</b> XML</a>
<ul>
<li class="chapter" data-level="11.1" data-path="xml.html"><a href="xml.html#bnc-spoken-2014"><i class="fa fa-check"></i><b>11.1</b> BNC Spoken 2014</a></li>
<li class="chapter" data-level="11.2" data-path="xml.html"><a href="xml.html#process-the-whole-directory-of-bnc2014-sample"><i class="fa fa-check"></i><b>11.2</b> Process the Whole Directory of BNC2014 Sample</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="xml.html"><a href="xml.html#define-function"><i class="fa fa-check"></i><b>11.2.1</b> Define Function</a></li>
<li class="chapter" data-level="11.2.2" data-path="xml.html"><a href="xml.html#process-the-all-files-in-the-directory"><i class="fa fa-check"></i><b>11.2.2</b> Process the all files in the Directory</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="xml.html"><a href="xml.html#metadata"><i class="fa fa-check"></i><b>11.3</b> Metadata</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="xml.html"><a href="xml.html#text-metadata"><i class="fa fa-check"></i><b>11.3.1</b> Text Metadata</a></li>
<li class="chapter" data-level="11.3.2" data-path="xml.html"><a href="xml.html#speaker-metadata"><i class="fa fa-check"></i><b>11.3.2</b> Speaker Metadata</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="xml.html"><a href="xml.html#bnc2014-for-socio-linguistic-variation"><i class="fa fa-check"></i><b>11.4</b> BNC2014 for Socio-linguistic Variation</a></li>
<li class="chapter" data-level="11.5" data-path="xml.html"><a href="xml.html#lexical-analysis"><i class="fa fa-check"></i><b>11.5</b> Lexical Analysis</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="xml.html"><a href="xml.html#word-frequency-vs.-gender"><i class="fa fa-check"></i><b>11.5.1</b> Word Frequency vs. Gender</a></li>
<li class="chapter" data-level="11.5.2" data-path="xml.html"><a href="xml.html#frequency-and-keyword-analysis"><i class="fa fa-check"></i><b>11.5.2</b> Frequency and Keyword Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="xml.html"><a href="xml.html#constructions-analysis"><i class="fa fa-check"></i><b>11.6</b> Constructions Analysis</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="xml.html"><a href="xml.html#from-token-based-to-turn-based-data-frame"><i class="fa fa-check"></i><b>11.6.1</b> From Token-based to Turn-based Data Frame</a></li>
<li class="chapter" data-level="11.6.2" data-path="xml.html"><a href="xml.html#degree-adv-adj"><i class="fa fa-check"></i><b>11.6.2</b> Degree ADV + ADJ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="vector-space-representation.html"><a href="vector-space-representation.html"><i class="fa fa-check"></i><b>12</b> Vector Space Representation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="vector-space-representation.html"><a href="vector-space-representation.html#distributional-semantics"><i class="fa fa-check"></i><b>12.1</b> Distributional Semantics</a></li>
<li class="chapter" data-level="12.2" data-path="vector-space-representation.html"><a href="vector-space-representation.html#vector-space-semantics-parameters"><i class="fa fa-check"></i><b>12.2</b> Vector Space Semantics: Parameters</a></li>
<li class="chapter" data-level="12.3" data-path="vector-space-representation.html"><a href="vector-space-representation.html#vector-space-model-for-documents"><i class="fa fa-check"></i><b>12.3</b> Vector Space Model for Documents</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="vector-space-representation.html"><a href="vector-space-representation.html#data-processing-flowchart"><i class="fa fa-check"></i><b>12.3.1</b> Data Processing Flowchart</a></li>
<li class="chapter" data-level="12.3.2" data-path="vector-space-representation.html"><a href="vector-space-representation.html#document-feature-matrix-dfm"><i class="fa fa-check"></i><b>12.3.2</b> Document-Feature Matrix (<code>dfm</code>)</a></li>
<li class="chapter" data-level="12.3.3" data-path="vector-space-representation.html"><a href="vector-space-representation.html#corpus-1"><i class="fa fa-check"></i><b>12.3.3</b> Corpus</a></li>
<li class="chapter" data-level="12.3.4" data-path="vector-space-representation.html"><a href="vector-space-representation.html#document-feature-matrix-dfm-1"><i class="fa fa-check"></i><b>12.3.4</b> Document-Feature Matrix (<code>dfm</code>)</a></li>
<li class="chapter" data-level="12.3.5" data-path="vector-space-representation.html"><a href="vector-space-representation.html#distance-similarity-metrics"><i class="fa fa-check"></i><b>12.3.5</b> Distributional Hypothesis and Distance/Similarity Metrics</a></li>
<li class="chapter" data-level="12.3.6" data-path="vector-space-representation.html"><a href="vector-space-representation.html#multidimensiona-space"><i class="fa fa-check"></i><b>12.3.6</b> Multidimensiona Space</a></li>
<li class="chapter" data-level="12.3.7" data-path="vector-space-representation.html"><a href="vector-space-representation.html#vector-semantics-considerations"><i class="fa fa-check"></i><b>12.3.7</b> Vector Semantics Considerations</a></li>
<li class="chapter" data-level="12.3.8" data-path="vector-space-representation.html"><a href="vector-space-representation.html#feature-selection"><i class="fa fa-check"></i><b>12.3.8</b> Feature Selection</a></li>
<li class="chapter" data-level="12.3.9" data-path="vector-space-representation.html"><a href="vector-space-representation.html#exploratory-analysis-of-dfm"><i class="fa fa-check"></i><b>12.3.9</b> Exploratory Analysis of <code>dfm</code></a></li>
<li class="chapter" data-level="12.3.10" data-path="vector-space-representation.html"><a href="vector-space-representation.html#document-similarity"><i class="fa fa-check"></i><b>12.3.10</b> Document Similarity</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="vector-space-representation.html"><a href="vector-space-representation.html#vector-space-model-for-words"><i class="fa fa-check"></i><b>12.4</b> Vector Space Model for Words</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="vector-space-representation.html"><a href="vector-space-representation.html#feature-coocurrence-matrix-fcm"><i class="fa fa-check"></i><b>12.4.1</b> Feature-Coocurrence Matrix (<code>fcm</code>)</a></li>
<li class="chapter" data-level="12.4.2" data-path="vector-space-representation.html"><a href="vector-space-representation.html#from-corpustokens-to-fcm"><i class="fa fa-check"></i><b>12.4.2</b> From <code>corpus/tokens</code> to <code>fcm</code></a></li>
<li class="chapter" data-level="12.4.3" data-path="vector-space-representation.html"><a href="vector-space-representation.html#from-dfm-to-fcm"><i class="fa fa-check"></i><b>12.4.3</b> From <code>dfm</code> to <code>fcm</code></a></li>
<li class="chapter" data-level="12.4.4" data-path="vector-space-representation.html"><a href="vector-space-representation.html#which-method-to-choose"><i class="fa fa-check"></i><b>12.4.4</b> Which method to choose?</a></li>
<li class="chapter" data-level="12.4.5" data-path="vector-space-representation.html"><a href="vector-space-representation.html#lexical-similarity"><i class="fa fa-check"></i><b>12.4.5</b> Lexical Similarity</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="vector-space-representation.html"><a href="vector-space-representation.html#exercises-1"><i class="fa fa-check"></i><b>12.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="" data-path=""><a href="#appendix-appendix"><i class="fa fa-check"></i>(APPENDIX) Appendix</a>
<ul>
<li><a href="vector-space-representation.html#install-the-python-with-anaconda">Install the python with <span>Anaconda</span></a></li>
<li class="chapter" data-level="" data-path="vector-space-representation.html"><a href="vector-space-representation.html#create-conda-environment"><i class="fa fa-check"></i>Create Conda Environment</a></li>
<li class="chapter" data-level="" data-path="vector-space-representation.html"><a href="vector-space-representation.html#install-python-modules"><i class="fa fa-check"></i>Install Python Modules</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://web.ntnu.edu.tw/~alvinchen" target ="blank">Alvin Chen </a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Corpus Linguistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<script src="https://hypothes.is/embed.js" async></script>
<div id="creating-corpus" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Creating Corpus</h1>
<p>Linguistic data are important to us linguists. Data usually tell us something we don’t know, or something we are not sure of. In this chapter, I would like to show you a quick way to extract linguistic data from web pages, which is by now undoubtedly the largest source of textual data available.</p>
<p>While there are many existing text data collections (cf. <a href="#structured-coprus">Structured Corpus</a> and <a href="xml.html#xml">XML</a>), chances are that sometimes you still need to collect your own data for a particular research question. But please note that when you are creating your own corpus for specific research questions, always pay attention to the three important criteria: <strong>representativeness</strong>, <strong>authenticity</strong>, and <strong>size</strong>.</p>
<p>Following the spirit of tidy <svg viewBox="0 0 581 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"> <path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>, we will mainly do our tasks with the libraries of <code>tidyverse</code> and <code>rvests</code>.</p>
<div class="info">
<p>If you are new to <strong>tidyverse</strong> R, please check its <a href="https://www.tidyverse.org/learn/">official webpage</a> for learning resources.</p>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb1-1"><a href="creating-corpus.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Uncomment the following line for installation</span></span>
<span id="cb1-2"><a href="creating-corpus.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c(&quot;tidyverse&quot;, &quot;rvest&quot;))</span></span>
<span id="cb1-3"><a href="creating-corpus.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-4"><a href="creating-corpus.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<div id="html-structure" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> HTML Structure</h2>
<p>The <strong>H</strong>yper<strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage, or HTML is the standard markup language for documents designed to be displayed in a web browser.</p>
<div id="html-syntax" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> HTML Syntax</h3>
<p>To illustrate the structure of the HTML, please download the sample <code>html</code> file from: <code>demo_data/data-sample-html.html</code> and first open it with your browser.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html Rchunk"><code class="sourceCode html"><span id="cb2-1"><a href="creating-corpus.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></span>
<span id="cb2-2"><a href="creating-corpus.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;html&gt;</span></span>
<span id="cb2-3"><a href="creating-corpus.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;head&gt;</span></span>
<span id="cb2-4"><a href="creating-corpus.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;title&gt;</span>My First HTML <span class="kw">&lt;/title&gt;</span></span>
<span id="cb2-5"><a href="creating-corpus.html#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="creating-corpus.html#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/head&gt;</span></span>
<span id="cb2-7"><a href="creating-corpus.html#cb2-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="creating-corpus.html#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;body&gt;</span></span>
<span id="cb2-9"><a href="creating-corpus.html#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;h1&gt;</span> Introduction <span class="kw">&lt;/h1&gt;</span></span>
<span id="cb2-10"><a href="creating-corpus.html#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;p&gt;</span> Have you ever read the source code of a html page? This is how to get back to the course page: <span class="kw">&lt;a</span> <span class="er">href</span><span class="ot">=</span><span class="st">&quot;https://alvinntnu.github.io/NTNU_ENC2036_LECTURES/&quot;</span><span class="er">,</span> <span class="er">target</span><span class="ot">=</span><span class="st">&quot;_blank&quot;</span><span class="kw">&gt;</span>ENC2036<span class="kw">&lt;/a&gt;</span>. <span class="kw">&lt;/p&gt;</span></span>
<span id="cb2-11"><a href="creating-corpus.html#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;h1&gt;</span> Contents of the Page <span class="kw">&lt;/h1&gt;</span></span>
<span id="cb2-12"><a href="creating-corpus.html#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;p&gt;</span> Anything you can say about the page.....<span class="kw">&lt;/p&gt;</span></span>
<span id="cb2-13"><a href="creating-corpus.html#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">&lt;/body&gt;</span></span>
<span id="cb2-14"><a href="creating-corpus.html#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/html&gt;</span></span></code></pre></div>
<p>An <code>HTML</code> document includes several important elements (cf. Figure <a href="creating-corpus.html#fig:htmltag">3.1</a>):</p>
<ul>
<li><code>DTD</code>: document type definition which informs the browser about the version of the HTML standard that the document adheres to (e.g., <code>&lt;!DOCTYPE HTML&gt;</code>)</li>
<li><code>element</code>: the combination of start tag, content, and end tag (e.g, <code>&lt;title&gt;My First HTML&lt;/title&gt;</code>)</li>
<li><code>tag</code>: named braces that enclose the content and define its structural function (e.g., <code>title</code>, <code>body</code>, <code>p</code>)</li>
<li><code>attribute</code>: specific properties of the tag, which are often placed in the start end of the element (e.g., <code>&lt;a href= "index.html"&gt; Homepage &lt;/a&gt;</code>). They are expressed as <code>name = "value"</code> pairs.</li>
</ul>
<!-- ```{r echo=F, purl = F, out.width = "70%"} -->
<!-- htmltools::includeHTML("demo_data/my-first-html.html") -->
<!-- ``` -->
<div class="figure"><span style="display:block;" id="fig:htmltag"></span>
<img src="images/html-tag.png" alt="Syntax of An HTML Tag Element" width="90%" />
<p class="caption">
Figure 3.1: Syntax of An HTML Tag Element
</p>
</div>
<p>An <code>HTML</code> document starts with the root element <code>&lt;html&gt;</code>, which splits into two branches, <code>&lt;head&gt;</code> and <code>&lt;body&gt;</code>.</p>
<ul>
<li>Most of the webpage <strong>textual contents</strong> would go into the <code>&lt;body&gt;</code> part.</li>
<li>Most of the web-related codes and metadata (e.g., javascripts, CSS) are often included in the <code>&lt;head&gt;</code> part.</li>
</ul>
<p>All elements need to be strictly nested within each other in a well-formed and valid HTML file, as shown in Figure <a href="creating-corpus.html#fig:htmltree">3.2</a>.</p>
<div class="figure"><span style="display:block;" id="fig:htmltree"></span>
<img src="images/html-tree.png" alt="Tree Structure of An HTML Document" width="648" />
<p class="caption">
Figure 3.2: Tree Structure of An HTML Document
</p>
</div>
</div>
<div id="tags-and-attributes" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Tags and Attributes</h3>
<p>HTML has plenty of legal tags and attributes. On <a href="https://www.w3schools.com/html/html_basic.asp">W3CSchools</a>, there is a complete list of HTML tags and attributes for your reference. Common tags may include:</p>
<ul>
<li>Anchor tag <code>&lt;a&gt;</code></li>
<li>Metadata tag <code>&lt;meta&gt;</code></li>
<li>External tag <code>&lt;link&gt;</code></li>
<li>Emphasizing tags <code>&lt;b&gt;</code>, <code>&lt;i&gt;</code>, <code>&lt;strong&gt;</code></li>
<li>Paragraph tags <code>&lt;p&gt;</code></li>
<li>Heading tags <code>&lt;h1&gt;</code>, <code>&lt;h2&gt;</code>, <code>&lt;h3&gt;</code></li>
<li>Listing content tags <code>&lt;ul&gt;</code>, <code>&lt;ol&gt;</code></li>
<li>Block tags <code>&lt;div&gt;</code>, <code>&lt;span&gt;</code></li>
<li>Form-related tag <code>&lt;form&gt;</code>, <code>&lt;input&gt;</code></li>
<li>Foreign script tag <code>&lt;script&gt;</code></li>
<li>Table tag <code>&lt;table&gt;</code>, <code>&lt;th&gt;</code>, <code>&lt;tr&gt;</code>, <code>&lt;td&gt;</code></li>
</ul>
<p>You probably don’t have to know all the detail about the HTML tags and elements. However, in order to scrape the textual data from the Internet, you need to know at least from which parts of HTML elements you need your textual data from on the web pages.</p>
<div class="info">
<p>Usually, before you scrape the data from the webpage, bear the following questions in mind:</p>
<ul>
<li>From which HTML <strong>elements/tags</strong> would you like to extract the data for corpus construction?</li>
<li>Do you need the <strong>textual</strong> content of the HTML element?</li>
<li>Do you need a specific <strong>attribute</strong> of the HTML element?</li>
</ul>
</div>
</div>
<div id="css" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> CSS</h3>
<p>Cascading Style Sheet (CSS) is a language for describing the layout of HTML and other markup documents (e.g., XML).</p>
<p>HTML + CSS is by now the standard way to create and design web pages. The idea is that CSS specifies the formats/styles of the HTML elements. The following is an example of the CSS:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode css Rchunk"><code class="sourceCode css"><span id="cb3-1"><a href="creating-corpus.html#cb3-1" aria-hidden="true" tabindex="-1"></a>div<span class="fu">.warnings</span> {</span>
<span id="cb3-2"><a href="creating-corpus.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">color</span>: <span class="cn">pink</span><span class="op">;</span></span>
<span id="cb3-3"><a href="creating-corpus.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">font-family</span>: <span class="st">&quot;Arial&quot;</span></span>
<span id="cb3-4"><a href="creating-corpus.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  font-size: <span class="dv">120</span><span class="dt">%</span></span>
<span id="cb3-5"><a href="creating-corpus.html#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-6"><a href="creating-corpus.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="creating-corpus.html#cb3-7" aria-hidden="true" tabindex="-1"></a>h1 {</span>
<span id="cb3-8"><a href="creating-corpus.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">padding-top</span>: <span class="dv">20</span><span class="dt">px</span></span>
<span id="cb3-9"><a href="creating-corpus.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  padding-bottom: <span class="dv">20</span><span class="dt">px</span></span>
<span id="cb3-10"><a href="creating-corpus.html#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<style type="text/css">
div.warnings {
  color: pink;
  font-family: "Arial"
  font-size: 120%
}

h1 {
  padding-top: 20px
  padding-bottom: 20px
}
</style>
<div class="info">
<p>You probably would wonder how to link a set of CSS style definitions to an HTML document. There are in general three ways: inline, internal and external. You can learn more about this in <a href="https://www.w3schools.com/html/html_css.asp">W3School.com</a>.</p>
<p>Here I will show you an example of the <strong>internal</strong> method. Below is a CSS style definition for <code>&lt;h1&gt;</code>.</p>
<pre><code>h1 {
  color: red;
  margin-bottom: 2em;
}</code></pre>
<p>We can embed this within a <code>&lt;style&gt;...&lt;/style&gt;</code> element. Then you put the entire <code>&lt;style&gt;</code> element under <code>&lt;head&gt;</code> of the HTML file you would like to style.</p>
<pre><code>&lt;style&gt;
h1 {
  color: red;
  margin-bottom: 1.5em;
}
&lt;/style&gt;</code></pre>
<p>After you include the <code>&lt;style&gt;</code> in the HTML file, refresh the web page to see if the CSS style works.</p>
</div>
</div>
<div id="html-css-javascript" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> HTML + CSS ( + JavaScript)</h3>
<p><img src="images/web-page-design.png" width="80%" /></p>
<ul>
<li><a href="https://www.w3schools.com/">Try it</a>:
<ul>
<li>HTML: the language for building web pages</li>
<li>CSS: the language for styling web pages</li>
<li>JavaScript: the language for programming web pages</li>
</ul></li>
</ul>
</div>
</div>
<div id="web-crawling" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Web Crawling</h2>
<div class="warning">
<p>In the following demonstration, the text data scraped from the PTT forum is presented as it is without adjustment. However, please note that the language on PTT may strike some readers as profane, vulgar or even offensive.</p>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb6-1"><a href="creating-corpus.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="creating-corpus.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span></code></pre></div>
<p>In this tutorial, let’s assume that we like to scrape texts from <a href="https://www.ptt.cc/bbs/index.html">PTT Forum</a>. In particular, we will demonstrate how to scrape texts from the <a href="https://www.ptt.cc/bbs/Gossiping/index.html"><code>Gossiping</code></a> board of PTT.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb7-1"><a href="creating-corpus.html#cb7-1" aria-hidden="true" tabindex="-1"></a>ptt.url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.ptt.cc/bbs/Gossiping&quot;</span></span></code></pre></div>
<p>If you use your browser to view <a href="https://www.ptt.cc/bbs/Gossiping">PTT Gossiping</a> page, you would see that you need to go through the age verification before you can enter the content page. So, our first job is to pass through this age verification.</p>
<ul>
<li>First, we create an <code>session()</code> (like we open a browser linking to the page)</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb8-1"><a href="creating-corpus.html#cb8-1" aria-hidden="true" tabindex="-1"></a>gossiping.session <span class="ot">&lt;-</span> <span class="fu">session</span>(ptt.url)</span></code></pre></div>
<ul>
<li>Second, we extract the age verification form from the current page (<code>form</code> is also a defined HTML element)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb9-1"><a href="creating-corpus.html#cb9-1" aria-hidden="true" tabindex="-1"></a>gossiping.form <span class="ot">&lt;-</span> gossiping.session <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="creating-corpus.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">&quot;form&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="creating-corpus.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  html_form</span></code></pre></div>
<ul>
<li>Then we automatically submit an <code>yes</code> to the age verification form in the earlier created <code>session()</code> and create another session.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb10-1"><a href="creating-corpus.html#cb10-1" aria-hidden="true" tabindex="-1"></a>gossiping <span class="ot">&lt;-</span> <span class="fu">session_submit</span>(</span>
<span id="cb10-2"><a href="creating-corpus.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> gossiping.session,</span>
<span id="cb10-3"><a href="creating-corpus.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">form =</span> gossiping.form,</span>
<span id="cb10-4"><a href="creating-corpus.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">submit =</span> <span class="st">&quot;yes&quot;</span></span>
<span id="cb10-5"><a href="creating-corpus.html#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="creating-corpus.html#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="creating-corpus.html#cb10-7" aria-hidden="true" tabindex="-1"></a>gossiping</span></code></pre></div>
<pre class="Rout"><code>&lt;session&gt; https://www.ptt.cc/bbs/Gossiping/index.html
  Status: 200
  Type:   text/html; charset=utf-8
  Size:   14834</code></pre>
<p>Now our html <code>sesseion</code>, i.e., <code>gossiping</code>, should be on the front page of the <code>Gossiping</code> board.</p>
<hr />
<div class="info">
<p>
Most browsers come with the functionality to inspect the page source (i.e., HTML). This is very useful for web crawling. Before we scrape data from the webpage, we often need to inspect the structure of the web page first. Most importantly, we need to know (a) which HTML elements, or (b) which particular attributes/values of the HTML elements we are interested in .
</p>
</div>
<p><img src="images/view-page-source.png" width="80%" /><img src="images/view-page-source-2.png" width="80%" /></p>
<hr />
<ul>
<li>Next we need to find the most recent index page of the board</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb12-1"><a href="creating-corpus.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Decide the number of index pages ----</span></span>
<span id="cb12-2"><a href="creating-corpus.html#cb12-2" aria-hidden="true" tabindex="-1"></a>page.latest <span class="ot">&lt;-</span> gossiping <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="creating-corpus.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># extract all &lt;a&gt; elements</span></span>
<span id="cb12-4"><a href="creating-corpus.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co"># extract the attributes `href`</span></span>
<span id="cb12-5"><a href="creating-corpus.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">&quot;index[0-9]{2,}</span><span class="sc">\\</span><span class="st">.html&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># find the `href` with the index number</span></span>
<span id="cb12-6"><a href="creating-corpus.html#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_extract</span>(<span class="st">&quot;[0-9]+&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># extract the number</span></span>
<span id="cb12-7"><a href="creating-corpus.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb12-8"><a href="creating-corpus.html#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="creating-corpus.html#cb12-9" aria-hidden="true" tabindex="-1"></a>page.latest</span></code></pre></div>
<pre class="Rout"><code>[1] 39397</code></pre>
<ul>
<li>On the most recent index page, we need to extract the hyperlinks to the articles</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb14-1"><a href="creating-corpus.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retreive links -----</span></span>
<span id="cb14-2"><a href="creating-corpus.html#cb14-2" aria-hidden="true" tabindex="-1"></a>link <span class="ot">&lt;-</span> <span class="fu">str_c</span>(ptt.url, <span class="st">&quot;/index&quot;</span>, page.latest, <span class="st">&quot;.html&quot;</span>)</span>
<span id="cb14-3"><a href="creating-corpus.html#cb14-3" aria-hidden="true" tabindex="-1"></a>links.article <span class="ot">&lt;-</span> gossiping <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="creating-corpus.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session_jump_to</span>(link) <span class="sc">%&gt;%</span> <span class="co"># move session to the most recent page</span></span>
<span id="cb14-5"><a href="creating-corpus.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># extract article &lt;a&gt;</span></span>
<span id="cb14-6"><a href="creating-corpus.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># extract article &lt;a&gt; `href` attributes</span></span>
<span id="cb14-7"><a href="creating-corpus.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">&quot;[A-z]</span><span class="sc">\\</span><span class="st">.[0-9]+</span><span class="sc">\\</span><span class="st">.[A-z]</span><span class="sc">\\</span><span class="st">.[A-z0-9]+</span><span class="sc">\\</span><span class="st">.html&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># extract links</span></span>
<span id="cb14-8"><a href="creating-corpus.html#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="st">&quot;https://www.ptt.cc&quot;</span>,.)</span>
<span id="cb14-9"><a href="creating-corpus.html#cb14-9" aria-hidden="true" tabindex="-1"></a>links.article</span></code></pre></div>
<pre class="Rout"><code> [1] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750826.A.58A.html&quot;
 [2] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750854.A.EC9.html&quot;
 [3] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750896.A.4AE.html&quot;
 [4] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750914.A.67E.html&quot;
 [5] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750949.A.011.html&quot;
 [6] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750951.A.971.html&quot;
 [7] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750961.A.9EA.html&quot;
 [8] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750964.A.0FB.html&quot;
 [9] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750990.A.CF5.html&quot;
[10] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html&quot;
[11] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751037.A.0F3.html&quot;
[12] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751041.A.E41.html&quot;
[13] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751070.A.2DB.html&quot;
[14] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751080.A.EBA.html&quot;
[15] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751091.A.8E8.html&quot;
[16] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751118.A.AD7.html&quot;
[17] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751155.A.35A.html&quot;
[18] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751162.A.CE9.html&quot;
[19] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751173.A.E16.html&quot;</code></pre>
<ul>
<li>Next step is to scrape texts from each article hyperlink. Let’s consider one link first.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb16-1"><a href="creating-corpus.html#cb16-1" aria-hidden="true" tabindex="-1"></a>article.url <span class="ot">&lt;-</span> links.article[<span class="dv">1</span>]</span>
<span id="cb16-2"><a href="creating-corpus.html#cb16-2" aria-hidden="true" tabindex="-1"></a>temp.html <span class="ot">&lt;-</span> gossiping <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="creating-corpus.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session_jump_to</span>(article.url) <span class="co"># link to the article</span></span></code></pre></div>
<ul>
<li>Now the <code>temp.html</code> is like a browser on the article page. Because we are interested in the metadata and the contents of each article, now the question is: where are they in the HTML? We need to go back to the source page of the article HTML again:</li>
</ul>
<p><img src="images/view-page-source-3.png" width="100%" /></p>
<ul>
<li>After a closer inspection of the article HTML, we know that:
<ul>
<li>The metadata of the article are included in <code>&lt;span&gt;</code> tag elements, belonging to the class <code>class="article-meta-value"</code></li>
<li>The contents of the article are included in the <code>&lt;div&gt;</code> element, whose ID is <code>ID="main-content"</code></li>
</ul></li>
</ul>
<hr />
<ul>
<li>Now we are ready to extract the metadata of the article.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb17-1"><a href="creating-corpus.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract article metadata</span></span>
<span id="cb17-2"><a href="creating-corpus.html#cb17-2" aria-hidden="true" tabindex="-1"></a>article.header <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="creating-corpus.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.article-meta-value&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># get &lt;span&gt; of a particular class</span></span>
<span id="cb17-4"><a href="creating-corpus.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span>
<span id="cb17-5"><a href="creating-corpus.html#cb17-5" aria-hidden="true" tabindex="-1"></a>article.header</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;su27 (su27)&quot;                           
[2] &quot;Gossiping&quot;                             
[3] &quot;Re: [問卦] 台灣是不是真的比烏克蘭重要?&quot;
[4] &quot;Fri Feb 25 09:00:24 2022&quot;              </code></pre>
<div class="info">
<p>The metadata of each PTT article in fact includes four pieces of information: author, board name, title, post time. The above code retrieves directly the values of these metadata.</p>
<p>We can retrieve the tags of these metadata values as well:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb19-1"><a href="creating-corpus.html#cb19-1" aria-hidden="true" tabindex="-1"></a>temp.html <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="creating-corpus.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.article-meta-tag&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># get &lt;span&gt; of a particular class</span></span>
<span id="cb19-3"><a href="creating-corpus.html#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>()</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;作者&quot; &quot;看板&quot; &quot;標題&quot; &quot;時間&quot;</code></pre>
</div>
<ul>
<li>From the <code>article.header</code>, we are able to extract the <code>author</code>, <code>title</code>, and <code>time stamp</code> of the article.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb21-1"><a href="creating-corpus.html#cb21-1" aria-hidden="true" tabindex="-1"></a>article.author <span class="ot">&lt;-</span> article.header[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_extract</span>(<span class="st">&quot;^[A-z0-9_]+&quot;</span>) <span class="co"># athuor</span></span>
<span id="cb21-2"><a href="creating-corpus.html#cb21-2" aria-hidden="true" tabindex="-1"></a>article.title <span class="ot">&lt;-</span> article.header[<span class="dv">3</span>] <span class="co"># title</span></span>
<span id="cb21-3"><a href="creating-corpus.html#cb21-3" aria-hidden="true" tabindex="-1"></a>article.datetime <span class="ot">&lt;-</span> article.header[<span class="dv">4</span>] <span class="co"># time stamp</span></span>
<span id="cb21-4"><a href="creating-corpus.html#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="creating-corpus.html#cb21-5" aria-hidden="true" tabindex="-1"></a>article.author</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;su27&quot;</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb23-1"><a href="creating-corpus.html#cb23-1" aria-hidden="true" tabindex="-1"></a>article.title</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;Re: [問卦] 台灣是不是真的比烏克蘭重要?&quot;</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb25-1"><a href="creating-corpus.html#cb25-1" aria-hidden="true" tabindex="-1"></a>article.datetime</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;Fri Feb 25 09:00:24 2022&quot;</code></pre>
<ul>
<li>Now we extract the main contents of the article</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb27-1"><a href="creating-corpus.html#cb27-1" aria-hidden="true" tabindex="-1"></a>article.content <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="creating-corpus.html#cb27-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>( <span class="co"># article body</span></span>
<span id="cb27-3"><a href="creating-corpus.html#cb27-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">xpath =</span> <span class="st">&#39;//div[@id=&quot;main-content&quot;]/node()[not(self::div|self::span[@class=&quot;f2&quot;])]&#39;</span></span>
<span id="cb27-4"><a href="creating-corpus.html#cb27-4" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="creating-corpus.html#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># extract texts</span></span>
<span id="cb27-6"><a href="creating-corpus.html#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>) <span class="co"># combine all lines into one</span></span>
<span id="cb27-7"><a href="creating-corpus.html#cb27-7" aria-hidden="true" tabindex="-1"></a>article.content</span></code></pre></div>
<pre class="Rout"><code>[1] &quot;自己國家自己救\n把自己的命運交到別人手上 不是蠢就是智障\n\n真不想打，就別搞到對方得出手\n普丁不出手 他位置就會坐不下去\n相同的 兩岸關係搞到習sir坐不下去\n就直接拼一拼\n\n目前發現只要跟美國講\n要打核戰 美國就龜縮了\n倒時也是只會給你武器 叫你自己打: 烏克蘭戰爭 台灣成為最後贏家: 因為美國要保留實力對抗中國: 丟掉烏克蘭 更凸顯不能失去台灣: 所以各國列強會投入更多資源給台灣抗中: 矢板明夫的看法 大家參考下--&quot;</code></pre>
<div class="info">
<p>
<code>XPath</code> (or XML Path Language) is a query language which is useful for addressing and extracting particular elements from XML/HTML documents. XPath allows you to exploit more features of the hierarchical tree that an HTML file represents in locating the relevant HTML elements. For more information, please see <span class="citation"><span class="citation"><a href="#ref-munzert2014" role="doc-biblioref">Munzert et al.</a> (<a href="#ref-munzert2014" role="doc-biblioref">2014</a>)</span></span>, Chapter 4.
</p>
<p>
In the above example, the <code>XPath</code> identifies the nodes <em>under</em> <code>&lt;div id = “main-content”&gt;</code>, but excludes sister nodes that are <code>&lt;div&gt;</code> or <code>&lt;span class=“f2”&gt;</code>.
</p>
<p>
These children <code>&lt;div&gt;</code> or <code>&lt;span class=“f2”&gt;</code> of the <code>&lt;div id = “main-content”&gt;</code> include the push comments (推文) of the article, which are not the main content of the article.
</p>
</div>
<ul>
<li>Now we combine all information related to the article into a data frame</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb29-1"><a href="creating-corpus.html#cb29-1" aria-hidden="true" tabindex="-1"></a>article.table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-2"><a href="creating-corpus.html#cb29-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">datetime =</span> article.datetime,</span>
<span id="cb29-3"><a href="creating-corpus.html#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> article.title,</span>
<span id="cb29-4"><a href="creating-corpus.html#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">author =</span> article.author,</span>
<span id="cb29-5"><a href="creating-corpus.html#cb29-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">content =</span> article.content,</span>
<span id="cb29-6"><a href="creating-corpus.html#cb29-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">url =</span> article.url</span>
<span id="cb29-7"><a href="creating-corpus.html#cb29-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-8"><a href="creating-corpus.html#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="creating-corpus.html#cb29-9" aria-hidden="true" tabindex="-1"></a>article.table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["datetime"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author"],"name":[3],"type":["chr"],"align":["left"]},{"label":["content"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Fri Feb 25 09:00:24 2022","2":"Re: [問卦] 台灣是不是真的比烏克蘭重要?","3":"su27","4":"自己國家自己救\\n把自己的命運交到別人手上 不是蠢就是智障\\n\\n真不想打，就別搞到對方得出手\\n普丁不出手 他位置就會坐不下去\\n相同的 兩岸關係搞到習sir坐不下去\\n就直接拼一拼\\n\\n目前發現只要跟美國講\\n要打核戰 美國就龜縮了\\n倒時也是只會給你武器 叫你自己打: 烏克蘭戰爭 台灣成為最後贏家: 因為美國要保留實力對抗中國: 丟掉烏克蘭 更凸顯不能失去台灣: 所以各國列強會投入更多資源給台灣抗中: 矢板明夫的看法 大家參考下--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750826.A.58A.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Next we extract the push comments at the end of the article</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb30-1"><a href="creating-corpus.html#cb30-1" aria-hidden="true" tabindex="-1"></a>article.push <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="creating-corpus.html#cb30-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">html_nodes</span>(<span class="at">xpath =</span> <span class="st">&quot;//div[@class = &#39;push&#39;]&quot;</span>)</span>
<span id="cb30-3"><a href="creating-corpus.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="creating-corpus.html#cb30-4" aria-hidden="true" tabindex="-1"></a>article.push</span></code></pre></div>
<pre class="Rout"><code>{xml_nodeset (0)}</code></pre>
<ul>
<li><p>We then extract relevant information from each push nodes <code>article.push</code>.</p>
<ul>
<li>push types</li>
<li>push authors</li>
<li>push contents</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb32-1"><a href="creating-corpus.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># push tags</span></span>
<span id="cb32-2"><a href="creating-corpus.html#cb32-2" aria-hidden="true" tabindex="-1"></a>push.table.tag <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="creating-corpus.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-tag&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="creating-corpus.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># push types (like or dislike)</span></span>
<span id="cb32-5"><a href="creating-corpus.html#cb32-5" aria-hidden="true" tabindex="-1"></a>push.table.tag</span></code></pre></div>
<pre class="Rout"><code>character(0)</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb34-1"><a href="creating-corpus.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># push authors</span></span>
<span id="cb34-2"><a href="creating-corpus.html#cb34-2" aria-hidden="true" tabindex="-1"></a>push.table.author <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="creating-corpus.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-userid&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-4"><a href="creating-corpus.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># author</span></span>
<span id="cb34-5"><a href="creating-corpus.html#cb34-5" aria-hidden="true" tabindex="-1"></a>push.table.author</span></code></pre></div>
<pre class="Rout"><code>character(0)</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb36-1"><a href="creating-corpus.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># push contents</span></span>
<span id="cb36-2"><a href="creating-corpus.html#cb36-2" aria-hidden="true" tabindex="-1"></a>push.table.content <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="creating-corpus.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-content&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="creating-corpus.html#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-5"><a href="creating-corpus.html#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="creating-corpus.html#cb36-6" aria-hidden="true" tabindex="-1"></a>push.table.content</span></code></pre></div>
<pre class="Rout"><code>character(0)</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb38-1"><a href="creating-corpus.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># push time</span></span>
<span id="cb38-2"><a href="creating-corpus.html#cb38-2" aria-hidden="true" tabindex="-1"></a>push.table.datetime <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="creating-corpus.html#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-ipdatetime&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="creating-corpus.html#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># push time stamp</span></span>
<span id="cb38-5"><a href="creating-corpus.html#cb38-5" aria-hidden="true" tabindex="-1"></a>push.table.datetime</span></code></pre></div>
<pre class="Rout"><code>character(0)</code></pre>
<ul>
<li>Finally, we combine all into one Push data frame.</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb40-1"><a href="creating-corpus.html#cb40-1" aria-hidden="true" tabindex="-1"></a>push.table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb40-2"><a href="creating-corpus.html#cb40-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">tag =</span> push.table.tag,</span>
<span id="cb40-3"><a href="creating-corpus.html#cb40-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">author =</span> push.table.author,</span>
<span id="cb40-4"><a href="creating-corpus.html#cb40-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">content =</span> push.table.content,</span>
<span id="cb40-5"><a href="creating-corpus.html#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">datetime =</span> push.table.datetime,</span>
<span id="cb40-6"><a href="creating-corpus.html#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">url =</span> article.url)</span>
<span id="cb40-7"><a href="creating-corpus.html#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="creating-corpus.html#cb40-8" aria-hidden="true" tabindex="-1"></a>push.table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tag"],"name":[1],"type":["chr"],"align":["left"]},{"label":["author"],"name":[2],"type":["chr"],"align":["left"]},{"label":["content"],"name":[3],"type":["chr"],"align":["left"]},{"label":["datetime"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="functional-programming" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Functional Programming</h2>
<p>It should now be clear that there are several routines that we need to do again and again if we want to collect text data in large amounts:</p>
<ul>
<li>For each index page, we need to extract all the article hyperlinks of the page.</li>
<li>For each article hyperlink, we need to extract the article content, metadata, and the push comments.</li>
</ul>
<p>So, it would be great if we can wrap these two routines into two functions.</p>
<div id="extract_art_links" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> <code>extract_art_links()</code></h3>
<ul>
<li><code>extract_art_links()</code>: This function takes an HTML session <code>session</code> and an index page of the PTT Gossiping <code>index_page</code> as the arguments and extract all article links from the index page. It returns a vector of article links.</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb41-1"><a href="creating-corpus.html#cb41-1" aria-hidden="true" tabindex="-1"></a>extract_art_links <span class="ot">&lt;-</span> <span class="cf">function</span>(index_page, session){</span>
<span id="cb41-2"><a href="creating-corpus.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  links.article <span class="ot">&lt;-</span> session <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="creating-corpus.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session_jump_to</span>(index_page) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="creating-corpus.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="creating-corpus.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="creating-corpus.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_subset</span>(<span class="st">&quot;[A-z]</span><span class="sc">\\</span><span class="st">.[0-9]+</span><span class="sc">\\</span><span class="st">.[A-z]</span><span class="sc">\\</span><span class="st">.[A-z0-9]+</span><span class="sc">\\</span><span class="st">.html&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="creating-corpus.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="st">&quot;https://www.ptt.cc&quot;</span>,.)</span>
<span id="cb41-8"><a href="creating-corpus.html#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="creating-corpus.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(links.article)</span>
<span id="cb41-10"><a href="creating-corpus.html#cb41-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>For example, we can extract all the article links from the most recent index page:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb42-1"><a href="creating-corpus.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get index page</span></span>
<span id="cb42-2"><a href="creating-corpus.html#cb42-2" aria-hidden="true" tabindex="-1"></a>cur_index_page <span class="ot">&lt;-</span> <span class="fu">str_c</span>(ptt.url, <span class="st">&quot;/index&quot;</span>, page.latest, <span class="st">&quot;.html&quot;</span>)</span>
<span id="cb42-3"><a href="creating-corpus.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all article links from the most recent index page</span></span>
<span id="cb42-4"><a href="creating-corpus.html#cb42-4" aria-hidden="true" tabindex="-1"></a>cur_art_links <span class="ot">&lt;-</span><span class="fu">extract_art_links</span>(cur_index_page, gossiping)</span>
<span id="cb42-5"><a href="creating-corpus.html#cb42-5" aria-hidden="true" tabindex="-1"></a>cur_art_links</span></code></pre></div>
<pre class="Rout"><code> [1] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750826.A.58A.html&quot;
 [2] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750854.A.EC9.html&quot;
 [3] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750896.A.4AE.html&quot;
 [4] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750914.A.67E.html&quot;
 [5] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750949.A.011.html&quot;
 [6] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750951.A.971.html&quot;
 [7] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750961.A.9EA.html&quot;
 [8] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750964.A.0FB.html&quot;
 [9] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645750990.A.CF5.html&quot;
[10] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html&quot;
[11] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751037.A.0F3.html&quot;
[12] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751041.A.E41.html&quot;
[13] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751070.A.2DB.html&quot;
[14] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751080.A.EBA.html&quot;
[15] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751091.A.8E8.html&quot;
[16] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751118.A.AD7.html&quot;
[17] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751155.A.35A.html&quot;
[18] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751162.A.CE9.html&quot;
[19] &quot;https://www.ptt.cc/bbs/Gossiping/M.1645751173.A.E16.html&quot;</code></pre>
</div>
<div id="extract_article_push_tables" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> <code>extract_article_push_tables()</code></h3>
<ul>
<li><code>extract_article_push_tables()</code>: This function takes an article link <code>link</code> as the argument and extracts the metadata, textual contents, and pushes of the article. It returns a <em>list</em> of two elements—article and push data frames.</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb44-1"><a href="creating-corpus.html#cb44-1" aria-hidden="true" tabindex="-1"></a>extract_article_push_tables <span class="ot">&lt;-</span> <span class="cf">function</span>(link){</span>
<span id="cb44-2"><a href="creating-corpus.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  article.url <span class="ot">&lt;-</span> link</span>
<span id="cb44-3"><a href="creating-corpus.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  temp.html <span class="ot">&lt;-</span> gossiping <span class="sc">%&gt;%</span> <span class="fu">session_jump_to</span>(article.url) <span class="co"># link to the www</span></span>
<span id="cb44-4"><a href="creating-corpus.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># article header</span></span>
<span id="cb44-5"><a href="creating-corpus.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  article.header <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="creating-corpus.html#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">&quot;span.article-meta-value&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># meta info regarding the article</span></span>
<span id="cb44-7"><a href="creating-corpus.html#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>()</span>
<span id="cb44-8"><a href="creating-corpus.html#cb44-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-9"><a href="creating-corpus.html#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># article meta</span></span>
<span id="cb44-10"><a href="creating-corpus.html#cb44-10" aria-hidden="true" tabindex="-1"></a>  article.author <span class="ot">&lt;-</span> article.header[<span class="dv">1</span>] <span class="sc">%&gt;%</span> <span class="fu">str_extract</span>(<span class="st">&quot;^[A-z0-9_]+&quot;</span>) <span class="co"># athuor</span></span>
<span id="cb44-11"><a href="creating-corpus.html#cb44-11" aria-hidden="true" tabindex="-1"></a>  article.title <span class="ot">&lt;-</span> article.header[<span class="dv">3</span>] <span class="co"># title</span></span>
<span id="cb44-12"><a href="creating-corpus.html#cb44-12" aria-hidden="true" tabindex="-1"></a>  article.datetime <span class="ot">&lt;-</span> article.header[<span class="dv">4</span>] <span class="co"># time stamp</span></span>
<span id="cb44-13"><a href="creating-corpus.html#cb44-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-14"><a href="creating-corpus.html#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># article content</span></span>
<span id="cb44-15"><a href="creating-corpus.html#cb44-15" aria-hidden="true" tabindex="-1"></a>  article.content <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="creating-corpus.html#cb44-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>( <span class="co"># article body</span></span>
<span id="cb44-17"><a href="creating-corpus.html#cb44-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">xpath =</span> <span class="st">&#39;//div[@id=&quot;main-content&quot;]/node()[not(self::div|self::span[@class=&quot;f2&quot;])]&#39;</span></span>
<span id="cb44-18"><a href="creating-corpus.html#cb44-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="creating-corpus.html#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-20"><a href="creating-corpus.html#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb44-21"><a href="creating-corpus.html#cb44-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-22"><a href="creating-corpus.html#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Merge article table </span></span>
<span id="cb44-23"><a href="creating-corpus.html#cb44-23" aria-hidden="true" tabindex="-1"></a>  article.table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-24"><a href="creating-corpus.html#cb44-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">datetime =</span> article.datetime,</span>
<span id="cb44-25"><a href="creating-corpus.html#cb44-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> article.title,</span>
<span id="cb44-26"><a href="creating-corpus.html#cb44-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">author =</span> article.author,</span>
<span id="cb44-27"><a href="creating-corpus.html#cb44-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">content =</span> article.content,</span>
<span id="cb44-28"><a href="creating-corpus.html#cb44-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">url =</span> article.url</span>
<span id="cb44-29"><a href="creating-corpus.html#cb44-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb44-30"><a href="creating-corpus.html#cb44-30" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb44-31"><a href="creating-corpus.html#cb44-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># push nodes</span></span>
<span id="cb44-32"><a href="creating-corpus.html#cb44-32" aria-hidden="true" tabindex="-1"></a>  article.push <span class="ot">&lt;-</span> temp.html <span class="sc">%&gt;%</span> </span>
<span id="cb44-33"><a href="creating-corpus.html#cb44-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="at">xpath =</span> <span class="st">&quot;//div[@class = &#39;push&#39;]&quot;</span>) <span class="co"># extracting pushes</span></span>
<span id="cb44-34"><a href="creating-corpus.html#cb44-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: If CSS is used, div.push does a lazy match (extracting div.push.... also)</span></span>
<span id="cb44-35"><a href="creating-corpus.html#cb44-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-36"><a href="creating-corpus.html#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># push tags    </span></span>
<span id="cb44-37"><a href="creating-corpus.html#cb44-37" aria-hidden="true" tabindex="-1"></a>  push.table.tag <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb44-38"><a href="creating-corpus.html#cb44-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-tag&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-39"><a href="creating-corpus.html#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># push types (like or dislike)</span></span>
<span id="cb44-40"><a href="creating-corpus.html#cb44-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-41"><a href="creating-corpus.html#cb44-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># push author id</span></span>
<span id="cb44-42"><a href="creating-corpus.html#cb44-42" aria-hidden="true" tabindex="-1"></a>  push.table.author <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb44-43"><a href="creating-corpus.html#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-userid&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-44"><a href="creating-corpus.html#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># author</span></span>
<span id="cb44-45"><a href="creating-corpus.html#cb44-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-46"><a href="creating-corpus.html#cb44-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># push content    </span></span>
<span id="cb44-47"><a href="creating-corpus.html#cb44-47" aria-hidden="true" tabindex="-1"></a>  push.table.content <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb44-48"><a href="creating-corpus.html#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-content&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-49"><a href="creating-corpus.html#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-50"><a href="creating-corpus.html#cb44-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-51"><a href="creating-corpus.html#cb44-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># push datetime      </span></span>
<span id="cb44-52"><a href="creating-corpus.html#cb44-52" aria-hidden="true" tabindex="-1"></a>  push.table.datetime <span class="ot">&lt;-</span> article.push <span class="sc">%&gt;%</span> </span>
<span id="cb44-53"><a href="creating-corpus.html#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">&quot;span.push-ipdatetime&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-54"><a href="creating-corpus.html#cb44-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="co"># push time stamp</span></span>
<span id="cb44-55"><a href="creating-corpus.html#cb44-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-56"><a href="creating-corpus.html#cb44-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># merge push table</span></span>
<span id="cb44-57"><a href="creating-corpus.html#cb44-57" aria-hidden="true" tabindex="-1"></a>  push.table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-58"><a href="creating-corpus.html#cb44-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">tag =</span> push.table.tag,</span>
<span id="cb44-59"><a href="creating-corpus.html#cb44-59" aria-hidden="true" tabindex="-1"></a>          <span class="at">author =</span> push.table.author,</span>
<span id="cb44-60"><a href="creating-corpus.html#cb44-60" aria-hidden="true" tabindex="-1"></a>          <span class="at">content =</span> push.table.content,</span>
<span id="cb44-61"><a href="creating-corpus.html#cb44-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">datetime =</span> push.table.datetime,</span>
<span id="cb44-62"><a href="creating-corpus.html#cb44-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">url =</span> article.url</span>
<span id="cb44-63"><a href="creating-corpus.html#cb44-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb44-64"><a href="creating-corpus.html#cb44-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-65"><a href="creating-corpus.html#cb44-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return</span></span>
<span id="cb44-66"><a href="creating-corpus.html#cb44-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-67"><a href="creating-corpus.html#cb44-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">article.table =</span> article.table, </span>
<span id="cb44-68"><a href="creating-corpus.html#cb44-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">push.table =</span> push.table))</span>
<span id="cb44-69"><a href="creating-corpus.html#cb44-69" aria-hidden="true" tabindex="-1"></a>}<span class="co">#endfunc</span></span></code></pre></div>
<p>For example, we can get the <code>article</code> and <code>push</code> tables from the first article link:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb45-1"><a href="creating-corpus.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_article_push_tables</span>(cur_art_links[<span class="dv">1</span>])</span></code></pre></div>
<pre class="Rout"><code>$article.table
# A tibble: 1 × 5
  datetime                 title       author content              url          
  &lt;chr&gt;                    &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;                &lt;chr&gt;        
1 Fri Feb 25 09:00:24 2022 Re: [問卦]… su27   &quot;自己國家自己救\n把… https://www.…

$push.table
# A tibble: 0 × 5
# … with 5 variables: tag &lt;chr&gt;, author &lt;chr&gt;, content &lt;chr&gt;, datetime &lt;chr&gt;,
#   url &lt;chr&gt;</code></pre>
</div>
<div id="streamline-the-codes" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Streamline the Codes</h3>
<p>Now we can simplify our codes quite a bit:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb47-1"><a href="creating-corpus.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get index page</span></span>
<span id="cb47-2"><a href="creating-corpus.html#cb47-2" aria-hidden="true" tabindex="-1"></a>cur_index_page <span class="ot">&lt;-</span> <span class="fu">str_c</span>(ptt.url, <span class="st">&quot;/index&quot;</span>, page.latest, <span class="st">&quot;.html&quot;</span>)</span>
<span id="cb47-3"><a href="creating-corpus.html#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="creating-corpus.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Scrape all article.tables and push.tables from each article hyperlink</span></span>
<span id="cb47-5"><a href="creating-corpus.html#cb47-5" aria-hidden="true" tabindex="-1"></a>cur_index_page <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="creating-corpus.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_art_links</span>(<span class="at">session =</span> gossiping) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="creating-corpus.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(extract_article_push_tables) <span class="ot">-&gt;</span> ptt_data</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb48-1"><a href="creating-corpus.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of articles on this index page</span></span>
<span id="cb48-2"><a href="creating-corpus.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ptt_data)</span></code></pre></div>
<pre class="Rout"><code>[1] 19</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb50-1"><a href="creating-corpus.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the first contents of 1st hyperlink</span></span>
<span id="cb50-2"><a href="creating-corpus.html#cb50-2" aria-hidden="true" tabindex="-1"></a>ptt_data[[<span class="dv">1</span>]]<span class="sc">$</span>article.table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["datetime"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author"],"name":[3],"type":["chr"],"align":["left"]},{"label":["content"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Fri Feb 25 09:00:24 2022","2":"Re: [問卦] 台灣是不是真的比烏克蘭重要?","3":"su27","4":"自己國家自己救\\n把自己的命運交到別人手上 不是蠢就是智障\\n\\n真不想打，就別搞到對方得出手\\n普丁不出手 他位置就會坐不下去\\n相同的 兩岸關係搞到習sir坐不下去\\n就直接拼一拼\\n\\n目前發現只要跟美國講\\n要打核戰 美國就龜縮了\\n倒時也是只會給你武器 叫你自己打: 烏克蘭戰爭 台灣成為最後贏家: 因為美國要保留實力對抗中國: 丟掉烏克蘭 更凸顯不能失去台灣: 所以各國列強會投入更多資源給台灣抗中: 矢板明夫的看法 大家參考下--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750826.A.58A.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb51-1"><a href="creating-corpus.html#cb51-1" aria-hidden="true" tabindex="-1"></a>ptt_data[[<span class="dv">1</span>]]<span class="sc">$</span>push.table</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tag"],"name":[1],"type":["chr"],"align":["left"]},{"label":["author"],"name":[2],"type":["chr"],"align":["left"]},{"label":["content"],"name":[3],"type":["chr"],"align":["left"]},{"label":["datetime"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<ul>
<li>Finally, the last thing we can do is to combine all article tables from each index page into one; and all push tables into one for later analysis.</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb52-1"><a href="creating-corpus.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge all article.tables into one</span></span>
<span id="cb52-2"><a href="creating-corpus.html#cb52-2" aria-hidden="true" tabindex="-1"></a>article.table.all <span class="ot">&lt;-</span> ptt_data <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="creating-corpus.html#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="cf">function</span>(x) x<span class="sc">$</span>article.table) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="creating-corpus.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  bind_rows</span>
<span id="cb52-5"><a href="creating-corpus.html#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="creating-corpus.html#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge all push.tables into one</span></span>
<span id="cb52-7"><a href="creating-corpus.html#cb52-7" aria-hidden="true" tabindex="-1"></a>push.table.all <span class="ot">&lt;-</span> ptt_data <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="creating-corpus.html#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="cf">function</span>(x) x<span class="sc">$</span>push.table) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="creating-corpus.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  bind_rows</span>
<span id="cb52-10"><a href="creating-corpus.html#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="creating-corpus.html#cb52-11" aria-hidden="true" tabindex="-1"></a>article.table.all</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["datetime"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author"],"name":[3],"type":["chr"],"align":["left"]},{"label":["content"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Fri Feb 25 09:00:24 2022","2":"Re: [問卦] 台灣是不是真的比烏克蘭重要?","3":"su27","4":"自己國家自己救\\n把自己的命運交到別人手上 不是蠢就是智障\\n\\n真不想打，就別搞到對方得出手\\n普丁不出手 他位置就會坐不下去\\n相同的 兩岸關係搞到習sir坐不下去\\n就直接拼一拼\\n\\n目前發現只要跟美國講\\n要打核戰 美國就龜縮了\\n倒時也是只會給你武器 叫你自己打: 烏克蘭戰爭 台灣成為最後贏家: 因為美國要保留實力對抗中國: 丟掉烏克蘭 更凸顯不能失去台灣: 所以各國列強會投入更多資源給台灣抗中: 矢板明夫的看法 大家參考下--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750826.A.58A.html"},{"1":"Fri Feb 25 09:00:49 2022","2":"[問卦] 烏克蘭士兵有認真學刺槍術嗎？","3":"LukeSkywaker","4":"烏克蘭的士兵有認真學刺槍術嗎？\\n\\n刺槍術這種厲害的作戰技能\\n\\n練得好的話，連俄軍也沒看在眼裡\\n\\n所以烏克蘭平常有在練刺槍術嗎？\\n\\n\\n--https://j.gifs.com/99Yq1D.gifhttps://j.gifs.com/lREJxM.gifhttps://j.gifs.com/vQLWl5.gif--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750854.A.EC9.html"},{"1":"Fri Feb 25 09:01:34 2022","2":"Re: [爆卦] 烏克蘭總統疑似搭飛機逃跑的影片","3":"treeson","4":"澤連斯基發表演說\\n\\n“我待在首都與我的人民，我的家人也是”https://bit.ly/3sjFKh2其他澤連斯基的照片https://i.imgur.com/ruiZdpP.jpghttps://i.imgur.com/X6qseFI.jpghttps://i.imgur.com/JbCJtKj.jpg烏克蘭真男人總統\\n\\n\\n\\n然後之前一直傳假新聞的到底要不要處理\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750896.A.4AE.html"},{"1":"Fri Feb 25 09:01:52 2022","2":"[新聞] 大陸收入 併入綜合所得申報","3":"apple1111","4":"1.媒體來源:\\n經濟日報\\n\\n2.記者署名:\\n程士華\\n\\n3.完整新聞標題:\\n大陸收入 併入綜合所得申報\\n\\n4.完整新聞內文:\\n2022/02/23 23:37:51\\n經濟日報 記者程士華／台北報導\\n\\n台商、台幹到中國大陸打拚，別忘了在台還有申報綜所稅的義務，台北國稅局表示，中國\\n大陸地區來源所得雖須併入綜合所得，國稅局卻不會提供相關資料，必須靠納稅義務人自\\n行申報，與台灣所得合併計稅。\\n\\n官員強調，依《台灣地區與大陸地區人民關係條例》第24條規定，我國人民取得中國大陸\\n地區來源所得，應併同台灣地區來源所得，課徵綜合所得稅，但是跟台灣所得不同的是，\\n國稅局的系統不會代入中國大陸地區的所得，因此須仰賴納稅義務人自行主動申報。\\n\\n在大多數的案例中，常常是中國大陸台商未申報當地所得，卻被國稅局以各式手段掌握，\\n近期便查到一位陳老闆，他於2019年出售在北京持有的不動產，出售收入換算為新台幣約\\n2,500萬元，扣除原始成本後，約有300萬元是出售獲利。\\n\\n陳老闆當年並無申報此項所得，官員表示，當事人主張都有好好申報綜所稅，是因為國稅\\n局的系統上未列出上述北京財產，才因而漏報。\\n\\n官員強調，既然是中國大陸地區來源所得，就算國稅局有掌握，依法也不在主動提供的資\\n料範圍內，因此應由納稅義務人自行申報，本案由於漏報所得，依《所得稅法》第110條\\n規定額外裁罰，平白讓陳老闆多了很多稅務成本。即便大陸所得要在台申報，也未必會多\\n繳稅，官員說，如同筆所得，在大陸已有繳納過所得稅，我國稅法允許可抵減台灣這裡的\\n應納稅額，不過最高抵減額度，至多僅限於該筆大陸來源所得，依我國適用綜所稅率計算\\n而增加的部分。\\n\\n5.完整新聞連結 (或短網址)需放媒體原始連結，不可用轉載媒體連結:https://money.udn.com/money/story/6710/61198016.備註:\\n\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750914.A.67E.html"},{"1":"Fri Feb 25 09:02:27 2022","2":"Re: [問卦] 我們台灣成年男性還是會誓死抵抗入侵","3":"claymath","4":": 剛查一下，我們台灣20到40歲成年男性有高達640多萬人耶: 如果敵人敢入侵我台灣: 我政府一下達全國動員令，像烏克蘭一樣強制徵召全國男性從軍: 那我們至少還有500萬的成年台灣男性加入國軍: 這麼強大的兵力還是可以保衛台灣耶: 再加上我們台灣全體人民上下一心，誓死抵抗敵人入侵: 根本不需要老美來幫我們打，我們自己的台灣成年男性就可以捍衛我們國家的安全啊: 有沒有我們台灣不需要國際派兵幫忙，我們自己就會誓死抵抗入侵者的八卦啊？你們是不是都忘了\\n台灣最近的棒球隊\\n就是在提前訓練街頭巷戰\\n用出其不意的方式打個你終身殘廢\\n\\n台灣8+9的c300跟bmw跟頭油大的車主\\n就是台灣的神風特攻隊\\n\\n\\n我們的柏油路\\n只有在都市化的地方才有好的路\\n其他鄉下的馬路根本走不了太重的卡車\\n何況是坦克\\n\\n台灣這些都不知道備多久了\\n\\n\\n----\\nSent fromBePTTon my iPhone 11 Pro\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750949.A.011.html"},{"1":"Fri Feb 25 09:02:29 2022","2":"[問卦] 如果俄羅斯承認台灣獨立","3":"Lieang","4":"如題，如果今天俄羅斯突然宣布承認台灣主權獨立並且發兵進駐台灣會怎樣？大家會接受嗎？有沒有掛？\\n-----\\nSent from JPTT on my iPhone\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750951.A.971.html"},{"1":"Fri Feb 25 09:02:39 2022","2":"Re: [問卦] 欸，G7要制裁俄羅斯","3":"CLOSED","4":"貼過的舊文再貼一次\\n\\n時間拉回北京冬奧開幕2002年2月2日\\n三年沒到中國的普亭  親自到北京參加開幕式\\n\\n兩天後 2月4日\\n俄國賣了一億噸的石油給中國\\n按協議價\\n（普亭表示：再過兩個禮拜  石油要大漲了\\n這裡有批低價石油賣給兄弟你 ）\\n所以俄國不缺錢  中國買到便宜石油\\n\\n冬奧結束兩天\\n普亭表示：兄弟你表演完了再來換我表演\\n\\n另外補充一點\\n烏克蘭是世界農業第五大國\\n中國每年跟他買很多糧食\\n\\n\\n你以為人家都想不到制裁嗎？\\n早就在做準備了: 所以我就說這些西方白種人和平太久: 連制裁有沒有效都不知道: 不跟俄國買天然氣?: 缺煤的中國笑了: 以後全部都運給中國: 不給俄國糧食?: 烏克蘭自己就歐洲產糧大國: 把烏吞下以後俄國糧食源源不絕: 俄國根本不用靠西方這些廢物: 光是俄烏中鐵三角就足夠組成自給自足的黃金三角了: 根本不用你們擔心^^--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750961.A.9EA.html"},{"1":"Fri Feb 25 09:02:42 2022","2":"[問卦] 所以台灣是不是下一個烏克蘭？","3":"david1124","4":"開戰前歐美大國都在宣稱要對俄羅斯發動制裁\\n開戰後卻還是當個吃瓜群眾\\n依然只會嘴砲\\n\\n這下可好了\\n中國已經知道原來這些歐美大國只會嘴遁 而已\\n以武力解放台灣難度大大降低\\n最大的威脅就只是咱們國軍\\n臺灣現在是不是也躲在烏克蘭背後瑟瑟發抖了呢？\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750964.A.0FB.html"},{"1":"Fri Feb 25 09:03:08 2022","2":"[問卦] 去年阿富汗 今年烏克蘭 明年？？？","3":"ig49999","4":"如題\\n\\n現在美國支撐的勢力逐漸瓦解\\n\\n美國上個世紀幫太多國家打仗了\\n\\n以巴衝突 朝鮮 越南\\n\\n從美國911到現在美國的態度也變化很大\\n\\n去年阿富汗 今年烏克蘭都關心但不介入\\n\\n明年輪到誰了？\\n\\n\\n\\n\\n\\n\\n--\\n我會\\n一直推薦愛莉莎莎\\n就是不忍八卦板這幾年世衰道微https://i.imgur.com/bcZHlp2.jpg--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645750990.A.CF5.html"},{"1":"Fri Feb 25 09:03:36 2022","2":"[問卦] 要如何才能加入督戰隊?","3":"xyz4594","4":"督戰隊  都是站在最後一排\\n\\n監督前方士兵\\n\\n如遇有向後逃離擾亂軍心之士兵\\n\\n即可開槍射殺\\n\\n使士兵只能面對敵人  別想存著僥倖逃離戰場之心態\\n\\n\\n這麼看來  督戰隊是不是戰場上最安全的職位?\\n\\n站在最後面  既不用遇到敵人\\n\\n一有甚麼事跑得也比誰都快\\n\\n\\n那麼要如何才能加入督戰隊?\\n\\n誰知道\\n\\n----","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"},{"1":"Fri Feb 25 09:03:54 2022","2":"Re: [問卦] 快醒醒吧，歐美態度很清楚了","3":"venson","4":"沒錯～我大米國統領拜登已經宣布對俄實施嚴厲經濟制裁，並且號召全美民眾為烏禱告。\\n不僅如此，歐美各國也已經提出聲援https://i.imgur.com/JlXKr5c.jpg沒錯～\\n英美法德等大國已經點燈祈福，希望給予烏克蘭光明，光明可以戰勝俄羅斯～\\n\\n大家點燈點起來～\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751037.A.0F3.html"},{"1":"Fri Feb 25 09:03:59 2022","2":"[問卦] 烏克蘭蹭北約，自食惡果","3":"teddy98","4":"烏克蘭以為加入北約就可以擺脫俄羅斯的威脅\\n\\n卻不知道這是玩火自焚\\n\\n\\n就如同台灣以為買到THAAD防衛系統可以擺脫中國的威脅\\n\\n但台灣至少比烏克蘭聰明多了\\n不會也不敢這樣玩\\n\\n\\n\\n這樣看來\\n烏克蘭被俄國打，也是剛好的而已？\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751041.A.E41.html"},{"1":"Fri Feb 25 09:04:28 2022","2":"[問卦] 我們不也是國際社會嗎","3":"Himawaridark","4":"我們偉大的三軍統帥以及她的小夥伴們，\\n都堅信的認為對面如果打過來，\\n國際社會會援助我們，\\n當初蘇阿公就算只有一支掃帚也要拼到底的精神，\\n真的很讓人感動。\\n\\n現在烏克蘭有難，\\n我們也是國際社會，\\n怎麼沒出兵援助烏克蘭。\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751070.A.2DB.html"},{"1":"Fri Feb 25 09:04:38 2022","2":"[問卦] 股票賠錢和交女朋友那個比較爽的八卦","3":"aabbcc520","4":"yoyo\\n\\n我高雄城5啦\\n\\n那個股票賠錢蠻爽的\\n\\n好奇交女朋友會爽嗎\\n\\n哪一個更爽\\n\\n本人處男沒交過女朋友\\n\\n請問有人可以分享嗎\\n\\n有沒有八卦\\n\\n\\n--\\n請支持柏木由紀 (天氣姊姊)>/////<https://i.imgur.com/8OWuQym.jpghttps://i.imgur.com/1c1buwl.jpghttps://i.imgur.com/dYS7Cq9.jpghttps://i.imgur.com/BKhcSDf.jpghttps://i.imgur.com/ZJH11Pj.jpg--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751080.A.EBA.html"},{"1":"Fri Feb 25 09:04:49 2022","2":"[問卦] 詐騙躲海外無邦交國家是不是就抓不到","3":"badbadook","4":"各位大屌大家好\\n\\n\\n\\n詐騙躲海外無邦交國\\n\\n\\n\\n用電話詐騙\\n\\n\\n\\n是不是就抓不到\\n\\n\\n\\n\\n鬼島人超可憐        只能封鎖電話號碼\\n\\n\\n\\n\\n天天給人騙到爽?\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751091.A.8E8.html"},{"1":"Fri Feb 25 09:05:16 2022","2":"[問卦] 我起床了 烏克蘭被俄羅斯打下來了嗎","3":"sos976431","4":"昨天一堆人在喊\\n\\n早上起床\\n\\n烏克蘭就不見了\\n\\n俄羅斯馬上就能車爆烏克蘭\\n\\n那現在\\n\\n烏克蘭還在嗎\\n\\n不是一堆人在吹俄羅斯=.=\\n\\n烏克蘭還在的話\\n\\n我明天早上再問一次\\n\\n有沒有掛\\n\\n我很好奇\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751118.A.AD7.html"},{"1":"Fri Feb 25 09:05:53 2022","2":"[問卦] 烏克蘭如果自己打贏會發生什麼事？","3":"cocogg","4":"如題，\\n若在孤立無援之下，烏克蘭自己打敗俄羅斯或是成功守住了烏東，接下來會發生什麼事？\\n\\n對戰後世界經濟政治有什麼影響嗎？\\n布丁大帝失去威信，換俄羅斯被看沒有？\\n\\n機率渺茫，然世界上沒有絕對的事。\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751155.A.35A.html"},{"1":"Fri Feb 25 09:06:00 2022","2":"[問卦] 烏克蘭如果向台灣求救的話會出兵嗎？","3":"q2203649","4":"如題\\n\\n烏克蘭現在向各方求援但是大家都不太愛鳥他，北約也講白了不會出兵。\\n\\n如果烏克蘭向台灣求援的話，台灣會出兵幫忙嗎？這麼大的一個幫台灣增加能見度的機會\\n會把握嗎？\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751162.A.CE9.html"},{"1":"Fri Feb 25 09:06:11 2022","2":"[問卦] 開戰時 台灣會被派去打仗的是哪種人？","3":"LargerThanU","4":"今日烏克蘭 明日台灣\\n\\n看烏克蘭被打成這樣 心有戚戚焉\\n\\n\\n假如現在台海戰爭爆發\\n\\n會第一個派去前線送死的是哪種人呢？\\n\\n\\n1.  覺青聖戰士\\n\\n2.  八卦偏激鍵盤鬥士\\n\\n3.  南部韭菜\\n\\n4.  台獨派政府官員\\n\\n\\n順帶一提 我替代役 是不是穩了？\\n\\n\\n\\n嘻嘻\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751173.A.E16.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb53-1"><a href="creating-corpus.html#cb53-1" aria-hidden="true" tabindex="-1"></a>push.table.all</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tag"],"name":[1],"type":["chr"],"align":["left"]},{"label":["author"],"name":[2],"type":["chr"],"align":["left"]},{"label":["content"],"name":[3],"type":["chr"],"align":["left"]},{"label":["datetime"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"噓","2":"clift","3":":台灣每年有數十萬無辜胎兒被父母墮胎 無法出世 這些被墮掉的","4":"10/27 22:21","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"},{"1":"→","2":"clift","3":":無辜生命絕大多數來自異性性行為","4":"10/27 22:22","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"},{"1":"→","2":"revorea","3":":不然同性性行為是會有胎兒喔...我該轉笨板嗎?","4":"10/27 22:23","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"},{"1":"推","2":"clift","3":":人工受孕也會有胎兒","4":"10/27 22:24","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"},{"1":"→","2":"revorea","3":":人工受孕再人工墮胎是腦殘喔...= =?","4":"10/27 22:27","5":"https://www.ptt.cc/bbs/Gossiping/M.1645751020.A.F51.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="danger">
<p>
There is still one problem with the Push data frame. Right now it is still not very clear how we can match the pushes to the articles from which they were extracted. The only shared index is the <code>url</code>. It would be better if all the articles in the data frame have their own unique indices and in the Push data frame each push comment corresponds to a particular article index.
</p>
</div>
<hr />
<p>The following graph summarizes our work flowchart for PTT Gossipping Scraping:</p>
<p><img src="images/ptt-crawling.png" width="90%" /></p>
</div>
</div>
<div id="save-corpus" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Save Corpus</h2>
<p>You can easily save your scraped texts in a <code>CSV</code> format.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb54-1"><a href="creating-corpus.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save ------</span></span>
<span id="cb54-2"><a href="creating-corpus.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(article.table, <span class="at">path =</span> <span class="st">&quot;PTT_GOSSIPPING_ARTICLE.csv&quot;</span>)</span>
<span id="cb54-3"><a href="creating-corpus.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(push.table, <span class="at">path =</span> <span class="st">&quot;PTT_GOSSIPPING_PUSH.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="additional-resources" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Additional Resources</h2>
<p>Collecting texts and digitizing them into machine-readable files is only the initial step for corpus construction. There are many other things that need to be considered to ensure the effectiveness and the sustainability of the corpus data. In particular, I would like to point you to a very useful resource, <a href="http://icar.cnrs.fr/ecole_thematique/contaci/documents/Baude/wynne.pdf">Developing Linguistic Corpora: A Guide to Good Practice</a>, compiled by Martin Wynne. Other important issues in corpus creation include:</p>
<ol style="list-style-type: decimal">
<li>Adding linguistic <strong>annotations</strong> to the corpus data (cf. Leech’s Chapter 2)</li>
<li><strong>Metadata</strong> representation of the documents (cf. Burnard’s Chapter 4)</li>
<li>Spoken corpora (cf. Thompson’s Chapter 5)</li>
<li>Technical parts for corpus creation (cf. Sinclair’s Appendix)</li>
</ol>
</div>
<div id="final-remarks" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Final Remarks</h2>
<ol style="list-style-type: decimal">
<li>Please pay attention to the ethical aspects involved in the process of web crawling (esp. with personal private matters).</li>
<li>If the website has their own API built specifically for one to gather data, use it instead of scraping.</li>
<li>Always read the terms and conditions provided by the website regarding data gathering.</li>
<li>Always be gentle with the data scraping (e.g., off-peak hours, spacing out the requests)</li>
<li>Value the data you gather and treat the data with respect.</li>
</ol>
<hr />

<div class="exercise">
<span id="exr:wcex1" class="exercise"><strong>Exercise 3.1  </strong></span>Can you modify the R codes so that the script can automatically scrape more than one index page?
</div>

<div class="exercise">
<p><span id="exr:unnamed-chunk-42" class="exercise"><strong>Exercise 3.2  </strong></span>Please utilize the code from Exercise <a href="creating-corpus.html#exr:wcex1">3.1</a> and collect all texts on <code>PTT/Gossipings</code> from <strong>3</strong> index pages. Please have the articles saved in <code>PTT_GOSSIPING_ARTICLE.csv</code> and the pushes saved in <code>PTT_GOSSIPING_PUSH.csv</code> under your working directory.</p>
<p>Also, at the end of your code, please also output in the Console the corpus size, including both the articles and the pushes. Please provide the total number of <em>characters</em> of all your PTT text data collected (Note: You DO NOT have to do the word segmentation yet. Please use the characters as the base unit for corpus size.)</p>
Hint: <code>nchar()</code>
</div>
<p><em>Your script may look something like:</em></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb55-1"><a href="creating-corpus.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I define my own `scrapePTT()` function:</span></span>
<span id="cb55-2"><a href="creating-corpus.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ptt_url: specify the board to scrape texts from</span></span>
<span id="cb55-3"><a href="creating-corpus.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co"># num_index_page: specify the number of index pages to be scraped</span></span>
<span id="cb55-4"><a href="creating-corpus.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># return: list(article, push)</span></span>
<span id="cb55-5"><a href="creating-corpus.html#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="creating-corpus.html#cb55-6" aria-hidden="true" tabindex="-1"></a>PTT_data <span class="ot">&lt;-</span><span class="fu">scrapePTT</span>(<span class="at">ptt_url =</span> <span class="st">&quot;https://www.ptt.cc/bbs/Gossiping&quot;</span>, <span class="at">num_index_page =</span> <span class="dv">3</span>)</span>
<span id="cb55-7"><a href="creating-corpus.html#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="creating-corpus.html#cb55-8" aria-hidden="true" tabindex="-1"></a>PTT_data<span class="sc">$</span>article <span class="sc">%&gt;%</span> head</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["datetime"],"name":[1],"type":["chr"],"align":["left"]},{"label":["title"],"name":[2],"type":["chr"],"align":["left"]},{"label":["author"],"name":[3],"type":["chr"],"align":["left"]},{"label":["content"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"Fri Feb 25 08:43:27 2022","2":"[新聞] 俄烏之戰美國被看破手腳？他5字預言「西方霸主」危險了","3":"rsreason","4":"俄烏之戰美國被看破手腳？他5字預言「西方霸主」危險了\\n\\n中時新聞網 王子瑄\\n\\n俄羅斯24日宣布將對烏克蘭採取「特種作戰」並發動飛彈攻擊，烏克蘭目前已至少有10座\\n城市淪陷。中山大學社科院前院長、現任民眾黨立委張其祿表示，此次烏東事件，美國多\\n數行動口惠實不至，美國不僅將失去國際社會信任，對美國長期佔據的西方國際社會領頭\\n羊角色也「確實有影響」，包括波羅的海三小國、中東歐的新民主盟邦國家，都會懷疑美\\n國的支持究竟到不到位。\\n\\n張其祿24日接受香港媒體《中評社》訪問指出，從去年美國在阿富汗倉皇撤兵，到現在俄\\n烏情勢的發展，美國作為西方民主盟國的頭，盟友們對其信任度確實遭衝擊。\\n\\n張其祿分析，烏克蘭情勢跟台灣有某種程度的相似性，都是夾在兩大強權之間，內部也有\\n親美、親俄、親中等爭論。張強調，小國關鍵在於能否自立自強、保有自主性的自助，若\\n只期待人助都非常不保險，必須讓自己擁有實力才是重點，像烏克蘭總統澤倫斯基也有點\\n後悔當初烏克蘭信任美國而廢除核武。\\n\\n針對美國是否失去國際社會的信任？張其祿直言，此次烏東事件，美國多數行動口惠實不\\n至，僅呼籲、制裁、要求同盟國給俄羅斯壓力，但卻沒有實質的協防等動作，這點對美國\\n西方領頭羊的角色「確實有影響」，將衝擊非傳統的盟邦對美國的信任度，例如波羅的海\\n三小國、中東歐的新民主盟邦國家等；但日本、韓國都是與美國關係較緊密的國家，實質\\n上也有正式的安保關係，對美國的信任感則不太會受到影響。https://www.chinatimes.com/realtimenews/20220225001059-260407?chdtv--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"Fri Feb 25 08:43:36 2022","2":"[問卦] 四行倉庫 和烏克蘭強奪機場？","3":"xxxd851130","4":"汝提\\n\\n四行倉庫\\n\\n和烏克蘭強奪機場\\n\\n是不是本質一樣\\n\\n是要做給國際看\\n\\n得到國際援助\\n\\n但後來都沒有得到援助呢？\\n\\n有沒有八卦\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749818.A.9F1.html"},{"1":"Fri Feb 25 08:43:38 2022","2":"Re: [問卦] 都教授:為何人類要自相殘殺呢?","3":"sxy67230","4":": 我有一位外星朋友: 在地球生活蠻長一段時間: 目前在當教授: 有時候我會跟他聊天打屁: 他問我: 為什麼你們人類會自相殘殺呢?: 打戰死這麼多人類同胞有啥好處?: 請問我該怎麼回應我朋友: 有沒有這方面的八卦?黑猩猩群之間也會有爭鬥，不要以為人類有多高等，你仔細去研究黑猩猩他們一樣有政治\\n，只是沒有人類那麼複雜化而已。\\n\\n黑猩猩一樣會為了利益互相勾結，殘殺其他群體，母黑猩猩也會為了溫飽去攀附其他黑猩\\n猩用性換取利益。\\n\\n你要說人類比較有智慧？我跟你說個事實，多數人都只是在混日子看著自己手邊那塊肉，\\n吹噓自己換取做愛機會而已啦！如果你真的去研究發現多數人類的腦袋智商就是跟百萬年\\n前我們的原始猿人祖先差不多而已，真的有智慧看透未來帶領人類的人本來就只是少數人\\n而已。而這些少數人早就不在乎房產、交配權、利益、政治、種族紛爭，只是一心想拉著\\n大家探索宇宙跟未知領域。\\n\\n可惜絕大多數人包含各國的政治人物跟意見領袖都只是想當黑猩猩王分配利益而已，不然\\n人類文明的發展會更快速的。\\n\\n嘻嘻\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749820.A.A7E.html"},{"1":"Fri Feb 25 08:43:46 2022","2":"[問卦] 烏克蘭人平常怎麼嘲諷俄羅斯任的？","3":"BlueOctober","4":"烏克蘭人 平常都怎麼嘲諷俄羅斯人的？\\n\\n故意提史達林，蘇聯？\\n\\n嘲笑他們沒有自由？不能投票？\\n\\n說他們玻璃心？在網路上做圖惡搞普丁？\\n\\n有專業烏克蘭人 可以說明一下嗎？\\n\\n如果你還能說話的話XD\\n\\n--\\nSent from my iPhone XR○PiTT//PHJCI--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749828.A.6C2.html"},{"1":"Fri Feb 25 08:44:59 2022","2":"[問卦] 台灣是不是真的比烏克蘭重要?","3":"mcuronan","4":"我想美國不出兵應該是烏克蘭沒那麼重要\\n\\n美國是不是在想萬一出兵烏克蘭\\n\\n中共趁機打台灣怎麼辦?\\n\\n所以想一想還是放生烏克蘭好了\\n\\n以防中共打台灣\\n\\n是不是真的台灣比較重要?\\n\\n有卦?\\n\\n-----\\nSent from JPTT on my Asus ASUS_X00TDB.\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749901.A.3DA.html"},{"1":"Fri Feb 25 08:45:10 2022","2":"Re: [問卦] 個性溫和 但不求上進 該做什麼工作？","3":"AsllaPiscu","4":": 好奇問一下: 個性溫和 能力差: 但不求上進 沒有野心: 不跟人競爭 直接認輸: 職場躺平族: 該做什麼工作: 有什麼國家考試比較適合這種個性的嗎？: 求推薦考科: 之前都在送熊貓: 也有在準備公務人員考試: 但一直沒考上: 有沒有比較好考的考試: 或是不用考的只要應徵就好的: 也比較適合這種個性的工作考學士後中醫系畢業後當躺平中醫\\n你只要力拼考上那次就好\\n（考大一程度的國文、英文、化學、生物）\\n入學之後基本上要嘛考古要嘛教授不會真的當人\\n見實習能撈就撈能混就混\\n兩階段國考基本上不要被外務影響或混過頭都會過\\n畢業後也不用去想著要作開業資格訓練\\n看哪邊有缺人就去加減做\\n藥方就照老師上課交代不要做的方式去開\\n因為那些很多都是老師自己用來輕鬆賺錢的方式\\n病人問問題就男的腎虧女的濕氣重\\n然後堅稱遵循古人智慧所以不用更新知識\\n說不定還能意外發大財\\n基本上八卦版版眾對中醫都很熟了\\n執業遇到什麼問題再上來丟個引戰標題\\n底下還會熱心提供各種族群的想法\\n大概4醬\\n\\n-----\\nSent from JPTT on my Asus ASUS_Z01RD.\\n\\n--","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749912.A.EF8.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb56-1"><a href="creating-corpus.html#cb56-1" aria-hidden="true" tabindex="-1"></a>PTT_data<span class="sc">$</span>push <span class="sc">%&gt;%</span> head</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["tag"],"name":[1],"type":["chr"],"align":["left"]},{"label":["author"],"name":[2],"type":["chr"],"align":["left"]},{"label":["content"],"name":[3],"type":["chr"],"align":["left"]},{"label":["datetime"],"name":[4],"type":["chr"],"align":["left"]},{"label":["url"],"name":[5],"type":["chr"],"align":["left"]}],"data":[{"1":"噓","2":"shiriri","3":": 台民黨真的滿滿支那走狗","4":"210.242.76.224 02/25 08:44","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"推","2":"say29217074","3":": 跟微博言論一樣 支持阿北的隊友","4":"49.216.185.110 02/25 08:44","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"推","2":"gn01693664","3":": 這記者 呵呵","4":"114.136.229.201 02/25 08:45","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"→","2":"CPer","3":": 塔綠班滿滿支那走狗","4":"220.138.48.171 02/25 08:45","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"→","2":"testone","3":": 美國世界第一強國地位被看破手腳","4":"49.216.89.234 02/25 08:45","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"},{"1":"噓","2":"gankgf","3":": 反美勢力認知作戰","4":"42.73.247.117 02/25 08:45","5":"https://www.ptt.cc/bbs/Gossiping/M.1645749809.A.357.html"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r Rchunk"><code class="sourceCode r"><span id="cb57-1"><a href="creating-corpus.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># corpus size</span></span>
<span id="cb57-2"><a href="creating-corpus.html#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="creating-corpus.html#cb57-3" aria-hidden="true" tabindex="-1"></a>PTT_data<span class="sc">$</span>article<span class="sc">$</span>content <span class="sc">%&gt;%</span> nchar <span class="sc">%&gt;%</span> sum</span></code></pre></div>
<pre class="Rout"><code>[1] 16041</code></pre>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Exercise 3.3  </strong></span>Please choose a website (other than PTT) you are interested in and demonstrate how you can use R to retrieve textual data from the site. The final scraped text collection could be from only one static web page. This purpose of this exercise is to show that you know how to parse the HTML structure of the web page and retrieve the data you need from the website.</p>
</div>
<!-- ```{exercise} -->
<!-- Now you should have basic ideas how we can crawl data from the Internet. Sometimes, we not only collect texts but statistics as well. Please try to collect the statistics of COVID-19 outbreak from the [Wikipedia 2019–20 coronavirus pandemic](https://en.wikipedia.org/wiki/2019%E2%80%9320_coronavirus_pandemic). Specifically, write a short script to automatically get the table included in the Wiki page, where the numbers of confirmed cases, deaths, and recoveries for each country are recorded. Your script should output a data frame as follows. Please name the columns of your data frame as follows as well. (Note: The numbers may vary because of the constant updates of the wiki page.) [*needs updating*] -->
<!-- ``` -->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-munzert2014" class="csl-entry">
Munzert, S., Rubba, C., Meißner, P., &amp; Nyhuis, D. (2014). <em>Automated data collection with <span>R</span>: A practical guide to web scraping and text mining</em>. John Wiley &amp; Sons.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-fundamentals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="corpus-analysis-a-start.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
